<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5, user-scalable=yes, viewport-fit=cover">
    <title>Jacky Â· è–ç­Šæ‹œå¹´</title>
    <style>
        /* ********** å®Œå…¨éœæ­¢ Â· ç„¡é–ƒçˆ Â· ç„¡é£„ç§» ********** */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #8b2e1a;  /* å–®ä¸€åº•è‰²ï¼Œç„¡æ¼¸å±¤ã€ç„¡å‹•ç•« */
            font-family: "Noto Serif TC", "æ¨™æ¥·é«”", "PingFang TC", sans-serif;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            position: relative;
        }

        /* ------------- ä¸»ç´…åŒ… Â· ç„¡ä»»ä½•å‹•ç•« ------------- */
        .red-card {
            background: #c43c1e;
            max-width: 580px;
            width: 100%;
            border-radius: 50px 50px 30px 30px;
            border: 10px solid #ffc56e;
            box-shadow: 0 12px 0 #6e351b;
            padding: 32px 24px;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 20;
        }

        .red-card::before {
            content: "ğŸ´ Jacky æ‹œå¹´ Â· ä¸™åˆå¹´ ğŸ´";
            position: absolute;
            top: -18px;
            left: 15%;
            width: 70%;
            background: #ffd966;
            color: #712e1a;
            font-size: min(26px, 5.5vw);
            font-weight: 900;
            text-align: center;
            padding: 10px 0;
            border-radius: 50px;
            border: 4px solid #ffa62b;
            box-shadow: 0 6px 0 #8f552a;
            letter-spacing: 6px;
            text-shadow: none;
        }

        /* è–ç­Šå¤§å­— Â· éœæ­¢ */
        .sheng-big {
            font-size: min(90px, 18vw);
            font-weight: 900;
            color: #fff0a5;
            text-shadow: 6px 6px 0 #64281a;
            line-height: 1;
            margin-top: 20px;
            margin-bottom: 8px;
        }

        /* ------------- ç­Šæ¯å€ Â· å®Œå…¨éœæ…‹ï¼Œåªæœ‰é»æ“Šæ•ˆæœ ------------- */
        .bwa-panel {
            background: #2d1a0e;
            border: 6px solid #ff9f2f;
            border-radius: 70px 70px 30px 30px;
            padding: 26px 22px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 16px;
            max-width: 580px;
            width: 100%;
            margin-top: 20px;
            box-shadow: 0 12px 0 #54381e;
            border-top: 8px solid #ffb84d;
        }

        .moon {
            font-size: min(120px, 22vw);
            background: #1e130c;
            padding: 8px 45px;
            border-radius: 180px;
            border: 6px solid #ffb84d;
            filter: drop-shadow(0 8px 0 #7a401a);
            line-height: 1;
            cursor: pointer;
            transition: none;  /* ç„¡å‹•ç•« */
        }

        .moon:active {
            opacity: 0.7;     /* åªæœ‰é»æ“Šå›é¥‹ï¼Œç„¡é–ƒçˆ */
        }

        .result-line {
            font-size: min(36px, 7.5vw);
            font-weight: 900;
            color: #ffeeb0;
            background: #412e1e;
            padding: 14px 24px;
            border-radius: 60px;
            border: 4px solid #ffa62b;
            text-align: center;
            width: 100%;
            letter-spacing: 4px;
        }

        .shake-btn {
            font-size: min(34px, 7vw);
            font-weight: 900;
            background: #3f281a;
            color: #ffdc8a;
            padding: 12px 28px;
            border-radius: 70px;
            border: 4px solid #ff9f2f;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
            cursor: pointer;
            border-bottom: 8px solid #614124;
            transition: none;
        }

        .shake-btn:active {
            opacity: 0.7;
            border-bottom-width: 8px;  /* ä¸ä½ç§»ï¼Œä¸é–ƒ */
        }

        /* ------------- ç¥ç¦è¨Šæ¯ Â· éœæ­¢ç½®åº• Â· ä¸é£„ä¸ç§» ------------- */
        .bless-message-area {
            width: 100%;
            max-width: 580px;
            min-height: 80px;
            background: #2f1e14;
            border: 4px solid #ffa52f;
            border-radius: 50px;
            margin-top: 25px;
            padding: 18px 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff6cf;
            font-size: min(32px, 7vw);
            font-weight: 900;
            text-align: center;
            word-break: break-word;
            letter-spacing: 6px;
            box-shadow: inset 0 0 0 2px #734d2a;
        }

        /* ------------- 3Då»Ÿå®‡ Â· éœæ­¢æ—‹è½‰ï¼ˆä½èª¿ï¼‰ ------------- */
        .temple-box {
            width: 100%;
            max-width: 580px;
            height: 200px;
            border-radius: 40px;
            overflow: hidden;
            border: 6px solid #ff9f2f;
            margin-top: 20px;
            background: #1e130e;
        }

        #templeCanvas {
            width: 100%;
            height: 100%;
            display: block;
        }

        /* éŸ³æ¨‚åˆ— Â· éœæ…‹ */
        .music-row {
            background: #1e130c;
            border: 4px solid #ff9f2f;
            border-radius: 70px;
            padding: 12px 22px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            max-width: 580px;
            width: 100%;
            margin-top: 18px;
        }

        .music-btn {
            background: #ffaa33;
            border: none;
            color: #2f1a0a;
            font-size: min(32px, 6.5vw);
            font-weight: bold;
            padding: 8px 26px;
            border-radius: 60px;
            border-bottom: 6px solid #7a4c26;
            cursor: pointer;
        }

        .music-btn:active {
            opacity: 0.7;
        }

        .footer-note {
            font-size: min(22px, 5vw);
            color: #ffcf8a;
            margin-top: 25px;
            letter-spacing: 8px;
            text-shadow: 2px 2px 0 #3a1c0e;
        }

        /* å®Œå…¨æ²’æœ‰ä»»ä½•å‹•ç•«ã€æ²’æœ‰é£„ç§»ã€æ²’æœ‰é–ƒçˆã€æ²’æœ‰è·‘é¦¬ç‡ˆ */
        /* æ‰€æœ‰ animation å…¨éƒ¨åˆªé™¤ */
    </style>
</head>
<body>

    <!-- ä¸»ç´…åŒ… Â· Jacky è³€æ­² Â· å®Œå…¨éœæ­¢ -->
    <div class="red-card">
        <div class="sheng-big">è–ç­Š</div>
        <div style="font-size: min(44px, 10vw); color: #ffecaa; text-shadow: 4px 4px 0 #5e2a1a;">
            ğŸ´ğŸ§§ğŸ¥¢
        </div>
    </div>

    <!-- ç­Šæ¯äº’å‹•å€ Â· ç„¡é–ƒçˆ -->
    <div class="bwa-panel">
        <div id="moonDisplay" class="moon">ğŸ¥¢ğŸ¥¢</div>
        <div id="resultMessage" class="result-line">ğŸ¥¢ Jacky è³œè–ç­Š</div>
        <div id="shakeArea" class="shake-btn">
            <span>ğŸ“³</span>
            <span>ğŸ¥¢</span>
            <span>æ– / é» è–ç­Š</span>
            <span>ğŸ¥¢</span>
        </div>
    </div>

    <!-- ç¥ç¦è¨Šæ¯ Â· å›ºå®šä¸å‹• Â· æ¯æ¬¡æ›´æ–°å…§å®¹ -->
    <div id="blessDisplay" class="bless-message-area">
        ğŸ´ æ–æ‰‹æ©Ÿ Â· å¾—è–ç­Š Â· æ¥ç¥ç¦
    </div>

    <!-- 3D å»Ÿå®‡ Â· å®‰éœæ—‹è½‰ï¼ˆç„¡é–ƒçˆï¼Œåªæœ‰æ…¢è½‰ï¼‰ -->
    <div class="temple-box">
        <canvas id="templeCanvas"></canvas>
    </div>

    <!-- éŸ³æ¨‚ Â· ç°¡æ½” -->
    <div class="music-row">
        <span style="font-size: min(32px, 6.5vw);">ğŸµ Jacky è³€æ­²</span>
        <button id="musicToggle" class="music-btn">ğŸ”Š</button>
    </div>

    <div class="footer-note">
        ğŸ¥¢ è–ç­Š Â· é¦¬å¹´å¤§å‰ ğŸ´
    </div>

    <!-- èƒŒæ™¯éŸ³æ¨‚ -->
    <audio id="bgMusic" loop preload="auto" style="display: none;">
        <source src="https://raw.githubusercontent.com/Sethjesus/newyear/main/horse.mp3" type="audio/mpeg">
    </audio>

    <!-- Three.js å»Ÿå®‡ -->
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.128.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.128.0/examples/jsm/"
            }
        }
    </script>

    <script type="module">
        // ---------- 3D å»Ÿå®‡ Â· å®‰éœç·©æ…¢æ—‹è½‰ ----------
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

        const canvas = document.getElementById('templeCanvas');
        const w = canvas.clientWidth;
        const h = canvas.clientHeight;

        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x2a1a12);

        const camera = new THREE.PerspectiveCamera(45, w / h, 0.1, 1000);
        camera.position.set(5, 3, 9.5);
        camera.lookAt(0, 1, 0);

        const renderer = new THREE.WebGLRenderer({ canvas, antialias: true });
        renderer.setSize(w, h);
        renderer.shadowMap.enabled = true;

        const ambient = new THREE.AmbientLight(0x6f4e3a);
        scene.add(ambient);
        const light = new THREE.DirectionalLight(0xffeedd, 1);
        light.position.set(5, 7, 9);
        light.castShadow = true;
        light.receiveShadow = true;
        scene.add(light);

        // ç°¡å–®å»Ÿå®‡æ¨¡å‹
        const ground = new THREE.Mesh(
            new THREE.CircleGeometry(11, 16),
            new THREE.MeshStandardMaterial({ color: 0x6b4f3c, roughness: 0.9 })
        );
        ground.rotation.x = -Math.PI / 2;
        ground.position.y = -0.02;
        ground.receiveShadow = true;
        scene.add(ground);

        const base = new THREE.Mesh(
            new THREE.BoxGeometry(4.6, 0.3, 4.2),
            new THREE.MeshStandardMaterial({ color: 0x8a6b4b })
        );
        base.position.set(0, 0.15, 0);
        base.castShadow = true;
        base.receiveShadow = true;
        scene.add(base);

        const wall = new THREE.Mesh(
            new THREE.BoxGeometry(4.2, 1.5, 3.8),
            new THREE.MeshStandardMaterial({ color: 0xb87333 })
        );
        wall.position.set(0, 1.0, 0);
        wall.castShadow = true;
        wall.receiveShadow = true;
        scene.add(wall);

        const roof = new THREE.Mesh(
            new THREE.ConeGeometry(3.5, 0.9, 4),
            new THREE.MeshStandardMaterial({ color: 0xcc8833 })
        );
        roof.position.set(0, 1.9, 0);
        roof.rotation.y = Math.PI / 4;
        roof.castShadow = true;
        scene.add(roof);

        // ç‡ˆç± 
        const lanternMat = new THREE.MeshStandardMaterial({ color: 0xd84c3c, emissive: 0x331111, emissiveIntensity: 0.1 });
        [[-1.3, 1.5, 1.3], [1.3, 1.5, 1.3], [0, 1.7, 1.3]].forEach(pos => {
            const l = new THREE.Mesh(new THREE.SphereGeometry(0.2), lanternMat);
            l.position.set(pos[0], pos[1], pos[2]);
            l.castShadow = true;
            scene.add(l);
        });

        // æ§åˆ¶ï¼šéå¸¸ç·©æ…¢çš„è‡ªè½‰ï¼Œç„¡é–ƒçˆ
        const controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.05;
        controls.autoRotate = true;
        controls.autoRotateSpeed = 0.8;      // å¾ˆæ…¢
        controls.enableZoom = true;
        controls.enablePan = true;
        controls.enableRotate = true;
        controls.enableTouchRotate = true;
        controls.target.set(0, 1.0, 0);

        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
        }
        animate();

        window.addEventListener('resize', () => {
            const w = canvas.clientWidth;
            const h = canvas.clientHeight;
            renderer.setSize(w, h);
            camera.aspect = w / h;
            camera.updateProjectionMatrix();
        });

        // ---------- äº’å‹•æ ¸å¿ƒ Â· ç„¡é£„ç§» Â· ç„¡é–ƒçˆ Â· ç¥ç¦å›ºå®šé¡¯ç¤º ----------
        const moon = document.getElementById('moonDisplay');
        const resultMsg = document.getElementById('resultMessage');
        const shakeArea = document.getElementById('shakeArea');
        const blessDisplay = document.getElementById('blessDisplay');
        const audio = document.getElementById('bgMusic');
        const musicBtn = document.getElementById('musicToggle');
        let isPlaying = false;

        // Jacky ç¥ç¦è©åº« Â· æ¸…æ¥š Â· ä¸äº‚
        const blessings = [
            "ğŸ´ Jacky ç¥ Â· é¦¬å¹´å¤§å‰",
            "ğŸ§§ Jacky è³€ Â· æ­å–œç™¼è²¡",
            "ğŸ’° Jacky è³œ Â· è²¡æºå»£é€²",
            "ğŸŒ¸ Jacky é¡˜ Â· é¦¬åˆ°æˆåŠŸ",
            "ğŸ® Jacky é€ Â· è–ç­Šé€£é€£",
            "âœ¨ Jacky ç¥ˆ Â· é‡‘é¦¬ç»ç‘",
            "ğŸ‹ Jacky ç›¼ Â· æ­¥æ­¥é«˜å‡",
            "ğŸŠ Jacky è´ˆ Â· å¤§å‰å¤§åˆ©",
            "ğŸ‡ Jacky ç¥ Â· å‰ç¨‹è¬é‡Œ",
            "ğŸŠ Jacky è³€ Â· äº”ç¦è‡¨é–€",
            "ğŸ¥¢ Jacky è³œ Â· è–ç­Šè–ç­Š",
            "ğŸ Jacky é¡˜ Â· é¦¬å¹´ç™¼è²¡"
        ];

        // éŸ³æ¨‚
        audio.volume = 0.35;
        audio.play().then(() => {
            isPlaying = true;
            musicBtn.textContent = 'ğŸ”Š';
        }).catch(() => {
            isPlaying = false;
            musicBtn.textContent = 'ğŸ”‡';
        });

        musicBtn.addEventListener('click', () => {
            if (isPlaying) {
                audio.pause();
                musicBtn.textContent = 'ğŸ”‡';
            } else {
                audio.play();
                musicBtn.textContent = 'ğŸ”Š';
            }
            isPlaying = !isPlaying;
        });

        // è–ç­Šï¼ä¸é£„ä¸ç§»ï¼Œåªæœ‰ä¸‹æ–¹ç¥ç¦å€æ”¹è®Šæ–‡å­—
        function doSheng() {
            // ç­Šæ¯çŸ­æš«å›é¥‹ï¼ˆç„¡å‹•ç•«ï¼Œåªæœ‰é¡è‰²ï¼‰
            moon.style.opacity = '0.7';
            setTimeout(() => { moon.style.opacity = '1'; }, 120);

            moon.textContent = 'ğŸ¥¢ğŸ¥¢';
            resultMsg.innerHTML = 'ğŸ¥¢ğŸ¥¢ Jacky è³œè–ç­Š';

            // éš¨æ©Ÿä¸€å¥ç¥ç¦ï¼Œç›´æ¥é¡¯ç¤ºåœ¨å›ºå®šæ¡†å…§
            const text = blessings[Math.floor(Math.random() * blessings.length)];
            blessDisplay.textContent = text;

            if (navigator.vibrate) navigator.vibrate(30);
        }

        // æ–æ™ƒåµæ¸¬
        let lastShake = 0;
        if (window.DeviceMotionEvent) {
            window.addEventListener('devicemotion', (e) => {
                const acc = e.accelerationIncludingGravity;
                if (!acc) return;
                const now = Date.now();
                if (now - lastShake < 1000) return;
                const x = Math.abs(acc.x || 0);
                const y = Math.abs(acc.y || 0);
                const z = Math.abs(acc.z || 0);
                if ((x > 9.8 || y > 9.8 || z > 9.8) && (x + y + z > 25)) {
                    lastShake = now;
                    doSheng();
                }
            });
        }

        // é»æ“Šäº’å‹•
        moon.addEventListener('click', doSheng);
        shakeArea.addEventListener('click', doSheng);

        // é è¨­é¡¯ç¤º
        blessDisplay.textContent = "ğŸ´ æ–æ‰‹æ©Ÿ Â· å¾—è–ç­Š Â· æ¥ç¥ç¦";
    </script>
</body>
</html>