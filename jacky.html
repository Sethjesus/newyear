<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5, user-scalable=yes, viewport-fit=cover">
    <title>Jacky Â· è–ç­Šæ‹œå¹´</title>
    <style>
        /* ä¹¾æ·¨ Â· å–œæ°£ Â· åªç•™é‡é» */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #8b2e1a;
            background: radial-gradient(circle at 30% 40%, #b34a2a, #5f1e0e);
            font-family: "Noto Serif TC", "æ¨™æ¥·é«”", "PingFang TC", sans-serif;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 16px;
            position: relative;
        }

        /* ------------- ä¸»ç´…åŒ… Â· å–®ç´”ç„¦é» ------------- */
        .red-card {
            background: #d8431e;
            background: linear-gradient(145deg, #e6552a, #bd3518);
            max-width: 580px;
            width: 100%;
            border-radius: 60px 60px 30px 30px;
            border: 12px solid #ffcf7a;
            box-shadow: 0 16px 0 #773d1e, 0 30px 50px rgba(0,0,0,0.6);
            padding: 36px 24px;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 20;
            animation: softFloat 3s infinite alternate;
        }

        @keyframes softFloat {
            from { transform: translateY(0px); }
            to   { transform: translateY(-6px); }
        }

        .red-card::before {
            content: "ğŸ´ Jacky æ‹œå¹´ Â· ä¸™åˆå¹´ ğŸ´";
            position: absolute;
            top: -18px;
            left: 15%;
            width: 70%;
            background: #ffdb7c;
            color: #792812;
            font-size: min(28px, 6vw);
            font-weight: 900;
            text-align: center;
            padding: 10px 0;
            border-radius: 60px;
            border: 5px solid #ffb82e;
            box-shadow: 0 8px 0 #9e602a;
            letter-spacing: 8px;
            text-shadow: 2px 2px 0 #ffe9ae;
        }

        /* è–ç­Šå¤§å­— */
        .sheng-big {
            font-size: min(100px, 20vw);
            font-weight: 900;
            color: #fff6b3;
            text-shadow: 8px 8px 0 #742818, 0 0 50px #ffcc44;
            line-height: 1;
            margin-top: 20px;
            margin-bottom: 8px;
            animation: glow 1.6s infinite alternate;
        }

        @keyframes glow {
            from { text-shadow: 8px 8px 0 #742818, 0 0 30px #ffcc44; }
            to   { text-shadow: 8px 8px 0 #742818, 0 0 70px #ffea80; }
        }

        /* ------------- ç­Šæ¯ Â· å”¯ä¸€äº’å‹• ------------- */
        .bwa-center {
            background: rgba(36, 18, 8, 0.95);
            backdrop-filter: blur(12px);
            border: 6px solid #ffaa3a;
            border-radius: 90px 90px 40px 40px;
            padding: 28px 24px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 16px;
            max-width: 580px;
            width: 100%;
            margin-top: 20px;
            box-shadow: 0 0 60px #ff8800;
            border-top: 12px solid #ffc44c;
        }

        .moon {
            font-size: min(130px, 24vw);
            background: #2c1a10;
            padding: 8px 50px;
            border-radius: 200px;
            border: 8px solid #ffc44c;
            filter: drop-shadow(0 0 30px #ffaa33);
            line-height: 1;
            transition: 0.08s;
            cursor: pointer;
        }

        .moon:active {
            transform: scale(0.94);
        }

        .result-line {
            font-size: min(40px, 9vw);
            font-weight: 900;
            color: #fff2b5;
            background: #55321e;
            padding: 16px 24px;
            border-radius: 70px;
            border: 6px solid #ffb042;
            text-align: center;
            width: 100%;
            letter-spacing: 6px;
        }

        .shake-btn {
            font-size: min(38px, 8vw);
            font-weight: 900;
            background: #4d2c1a;
            color: #ffe694;
            padding: 14px 32px;
            border-radius: 90px;
            border: 5px solid #ffa83a;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            width: 100%;
            cursor: pointer;
            transition: 0.05s;
            border-bottom: 8px solid #7a481e;
        }

        .shake-btn:active {
            transform: translateY(6px);
            border-bottom-width: 2px;
        }

        /* ------------- ç¥ç¦é£„è½ Â· ä¸€å¥ Â· æ¸…æ¥š ------------- */
        .bless-sky {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
            overflow: hidden;
        }

        .floating-bless {
            position: absolute;
            font-size: min(48px, 10vw);
            font-weight: 900;
            white-space: nowrap;
            background: linear-gradient(145deg, #ffefb0, #ffd46a);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 35px #ff6a00, 0 0 20px #ffaa33, 4px 4px 0 #542010;
            letter-spacing: 8px;
            animation: floatUp 4s ease-out forwards;
            filter: drop-shadow(0 0 20px #ffaa00);
            opacity: 0;
            z-index: 10000;
        }

        @keyframes floatUp {
            0% { opacity: 0; transform: translateY(30px) scale(0.7); }
            15% { opacity: 1; transform: translateY(-20px) scale(1.2); }
            80% { opacity: 1; transform: translateY(-180px) scale(1); }
            100% { opacity: 0; transform: translateY(-280px) scale(0.8); }
        }

        /* ------------- 3D å»Ÿå®‡ Â· å®‰éœèƒŒæ™¯ ------------- */
        .temple-box {
            width: 100%;
            max-width: 580px;
            height: 220px;
            border-radius: 50px;
            overflow: hidden;
            border: 6px solid #ffaa44;
            box-shadow: 0 0 40px #ff8800;
            margin-top: 20px;
        }

        #templeCanvas {
            width: 100%;
            height: 100%;
            display: block;
        }

        /* éŸ³æ¨‚åˆ— Â· ä½èª¿ */
        .music-row {
            background: rgba(20, 10, 5, 0.9);
            border: 4px solid #ffaa33;
            border-radius: 80px;
            padding: 12px 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            max-width: 580px;
            width: 100%;
            margin-top: 18px;
            box-shadow: 0 0 30px #ff9900;
        }

        .music-btn {
            background: #ffaa33;
            border: none;
            color: #2f1a0a;
            font-size: min(34px, 7vw);
            font-weight: bold;
            padding: 8px 28px;
            border-radius: 70px;
            border-bottom: 6px solid #7e4c24;
            cursor: pointer;
        }

        .music-btn:active {
            transform: translateY(5px);
            border-bottom-width: 2px;
        }

        .footer-note {
            font-size: min(24px, 5.5vw);
            color: #ffd9a3;
            margin-top: 25px;
            letter-spacing: 10px;
            text-shadow: 2px 2px 0 #3d1d0e;
        }

        /* å‹•ç•«è¼”åŠ© */
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .spin-slow {
            animation: spin 4s infinite linear;
            display: inline-block;
        }

        /* å®Œå…¨æ²’æœ‰æ»¿å¤©é£›èˆçš„æ–‡å­—å¹²æ“¾ï¼Œåªæœ‰ä¸€å¥ç¥ç¦ */
    </style>
</head>
<body>

    <!-- ç¥ç¦å®¹å™¨ï¼šæ¯æ¬¡åªé£„ä¸€å¥ï¼Œä¹¾æ·¨æ¸…æ¥š -->
    <div id="blessSky" class="bless-sky"></div>

    <!-- ä¸»ç´…åŒ… Â· Jacky è³€æ­² -->
    <div class="red-card">
        <div class="sheng-big">è–ç­Š</div>
        <div style="font-size: min(46px, 11vw); color: #ffeeb0; text-shadow: 4px 4px 0 #6a2a1a;">
            ğŸ´ğŸ§§ğŸ¥¢
        </div>
    </div>

    <!-- ç­Šæ¯äº’å‹•å€ Â· å”¯ä¸€ä»»å‹™ï¼šæ“²è–ç­Šã€é£„ç¥ç¦ -->
    <div class="bwa-center">
        <div id="moonDisplay" class="moon">ğŸ¥¢ğŸ¥¢</div>
        <div id="resultMessage" class="result-line">ğŸ¥¢ Jacky è³œè–ç­Š</div>
        <div id="shakeArea" class="shake-btn">
            <span>ğŸ“³</span>
            <span class="spin-slow">ğŸ¥¢</span>
            <span>æ– / é» è–ç­Š</span>
            <span class="spin-slow">ğŸ¥¢</span>
        </div>
    </div>

    <!-- 3D å»Ÿå®‡ Â· å®‰éœç¥ˆç¦ -->
    <div class="temple-box">
        <canvas id="templeCanvas"></canvas>
    </div>

    <!-- éŸ³æ¨‚ Â· ç°¡æ½” -->
    <div class="music-row">
        <span style="font-size: min(34px, 7vw); display: flex; gap: 8px;">
            <span class="spin-slow">ğŸµ</span> Jacky è³€æ­²
        </span>
        <button id="musicToggle" class="music-btn">ğŸ”Š</button>
    </div>

    <div class="footer-note">
        ğŸ¥¢ è–ç­Š Â· é¦¬å¹´å¤§å‰ ğŸ´
    </div>

    <!-- èƒŒæ™¯éŸ³æ¨‚ -->
    <audio id="bgMusic" loop preload="auto" style="display: none;">
        <source src="https://raw.githubusercontent.com/Sethjesus/newyear/main/horse.mp3" type="audio/mpeg">
    </audio>

    <!-- Three.js å»Ÿå®‡ -->
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.128.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.128.0/examples/jsm/"
            }
        }
    </script>

    <script type="module">
        // ---------- 3D å»Ÿå®‡ Â· å®‰éœèƒŒæ™¯ ----------
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

        const canvas = document.getElementById('templeCanvas');
        const w = canvas.clientWidth;
        const h = canvas.clientHeight;

        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x2f1c12);

        const camera = new THREE.PerspectiveCamera(45, w / h, 0.1, 1000);
        camera.position.set(4.8, 2.8, 9.5);
        camera.lookAt(0, 1, 0);

        const renderer = new THREE.WebGLRenderer({ canvas, antialias: true });
        renderer.setSize(w, h);
        renderer.shadowMap.enabled = true;

        const ambient = new THREE.AmbientLight(0x6f4e3a);
        scene.add(ambient);
        const light = new THREE.DirectionalLight(0xffeedd, 1);
        light.position.set(5, 7, 9);
        light.castShadow = true;
        light.receiveShadow = true;
        scene.add(light);

        // ç°¡å–®å»Ÿ
        const ground = new THREE.Mesh(
            new THREE.CircleGeometry(11, 16),
            new THREE.MeshStandardMaterial({ color: 0x6b4f3c, roughness: 0.8 })
        );
        ground.rotation.x = -Math.PI / 2;
        ground.position.y = -0.02;
        ground.receiveShadow = true;
        scene.add(ground);

        const base = new THREE.Mesh(
            new THREE.BoxGeometry(4.6, 0.3, 4.2),
            new THREE.MeshStandardMaterial({ color: 0x8a6b4b })
        );
        base.position.set(0, 0.15, 0);
        base.castShadow = true;
        base.receiveShadow = true;
        scene.add(base);

        const wall = new THREE.Mesh(
            new THREE.BoxGeometry(4.2, 1.5, 3.8),
            new THREE.MeshStandardMaterial({ color: 0xb87333 })
        );
        wall.position.set(0, 1.0, 0);
        wall.castShadow = true;
        wall.receiveShadow = true;
        scene.add(wall);

        const roof = new THREE.Mesh(
            new THREE.ConeGeometry(3.5, 0.9, 4),
            new THREE.MeshStandardMaterial({ color: 0xcc8833 })
        );
        roof.position.set(0, 1.9, 0);
        roof.rotation.y = Math.PI / 4;
        roof.castShadow = true;
        scene.add(roof);

        // ç‡ˆç± 
        const lanternMat = new THREE.MeshStandardMaterial({ color: 0xd84c3c, emissive: 0x331111 });
        [[-1.3, 1.5, 1.3], [1.3, 1.5, 1.3], [0, 1.7, 1.3]].forEach(pos => {
            const l = new THREE.Mesh(new THREE.SphereGeometry(0.2), lanternMat);
            l.position.set(pos[0], pos[1], pos[2]);
            l.castShadow = true;
            scene.add(l);
        });

        const controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.autoRotate = true;
        controls.autoRotateSpeed = 1.2;
        controls.enableZoom = true;
        controls.enablePan = true;
        controls.target.set(0, 1.0, 0);

        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
        }
        animate();

        window.addEventListener('resize', () => {
            const w = canvas.clientWidth;
            const h = canvas.clientHeight;
            renderer.setSize(w, h);
            camera.aspect = w / h;
            camera.updateProjectionMatrix();
        });

        // ---------- äº’å‹•æ ¸å¿ƒ Â· ä¹¾æ·¨ Â· ä¸€å¥ç¥ç¦ ----------
        const moon = document.getElementById('moonDisplay');
        const resultMsg = document.getElementById('resultMessage');
        const shakeArea = document.getElementById('shakeArea');
        const blessSky = document.getElementById('blessSky');
        const audio = document.getElementById('bgMusic');
        const musicBtn = document.getElementById('musicToggle');
        let isPlaying = false;

        // Jacky ç¥ç¦è©åº« Â· æ¯ä¸€å¥éƒ½æ¸…æ¥šæœ‰åŠ›
        const blessings = [
            "ğŸ´ Jacky ç¥ Â· é¦¬å¹´å¤§å‰",
            "ğŸ§§ Jacky è³€ Â· æ­å–œç™¼è²¡",
            "ğŸ’° Jacky è³œ Â· è²¡æºå»£é€²",
            "ğŸŒ¸ Jacky é¡˜ Â· é¦¬åˆ°æˆåŠŸ",
            "ğŸ® Jacky é€ Â· è–ç­Šé€£é€£",
            "âœ¨ Jacky ç¥ˆ Â· é‡‘é¦¬ç»ç‘",
            "ğŸ‹ Jacky ç›¼ Â· æ­¥æ­¥é«˜å‡",
            "ğŸŠ Jacky è´ˆ Â· å¤§å‰å¤§åˆ©",
            "ğŸ‡ Jacky ç¥ Â· å‰ç¨‹è¬é‡Œ",
            "ğŸŠ Jacky è³€ Â· äº”ç¦è‡¨é–€",
            "ğŸ¥¢ Jacky è³œ Â· è–ç­Šè–ç­Š",
            "ğŸ Jacky é¡˜ Â· é¦¬å¹´ç™¼è²¡"
        ];

        // éŸ³æ¨‚
        audio.volume = 0.4;
        audio.play().then(() => {
            isPlaying = true;
            musicBtn.textContent = 'ğŸ”Š';
        }).catch(() => {
            isPlaying = false;
            musicBtn.textContent = 'ğŸ”‡';
        });

        musicBtn.addEventListener('click', () => {
            if (isPlaying) {
                audio.pause();
                musicBtn.textContent = 'ğŸ”‡';
            } else {
                audio.play();
                musicBtn.textContent = 'ğŸ”Š';
            }
            isPlaying = !isPlaying;
        });

        // é£„è½ä¸€å¥ç¥ç¦ï¼ˆä¹¾æ·¨ç‰ˆï¼‰
        function floatOneBless() {
            const div = document.createElement('div');
            div.className = 'floating-bless';
            
            // éš¨æ©Ÿä¸€å¥
            const text = blessings[Math.floor(Math.random() * blessings.length)];
            div.textContent = text;

            // ä½ç½®ï¼šåä¸­ä¸‹ï¼Œå¾€ä¸Šé£„
            const left = window.innerWidth * (0.2 + Math.random() * 0.6);
            const top = window.innerHeight * 0.7;

            div.style.left = left + 'px';
            div.style.top = top + 'px';
            
            // éš¨æ©Ÿå°è®ŠåŒ–
            const size = 44 + Math.floor(Math.random() * 20);
            div.style.fontSize = size + 'px';
            div.style.animationDuration = 3.5 + Math.random() * 1 + 's';

            blessSky.appendChild(div);

            setTimeout(() => {
                if (div.parentNode) div.remove();
            }, 5000);
        }

        // è–ç­Šï¼
        function doSheng() {
            // ç­Šæ¯å‹•ç•«
            moon.classList.add('shake-animation');
            setTimeout(() => {
                moon.classList.remove('shake-animation');
            }, 400);

            moon.textContent = 'ğŸ¥¢ğŸ¥¢';
            resultMsg.innerHTML = 'ğŸ¥¢ğŸ¥¢ Jacky è³œè–ç­Š';

            if (navigator.vibrate) navigator.vibrate(40);

            // åªé£„ä¸€å¥ç¥ç¦ï¼Œä¹¾æ·¨ä¸äº‚
            floatOneBless();
        }

        // æ–æ™ƒåµæ¸¬
        let lastShake = 0;
        if (window.DeviceMotionEvent) {
            window.addEventListener('devicemotion', (e) => {
                const acc = e.accelerationIncludingGravity;
                if (!acc) return;
                const now = Date.now();
                if (now - lastShake < 900) return;
                const x = Math.abs(acc.x || 0);
                const y = Math.abs(acc.y || 0);
                const z = Math.abs(acc.z || 0);
                if ((x > 9.5 || y > 9.5 || z > 9.5) && (x + y + z > 24)) {
                    lastShake = now;
                    doSheng();
                }
            });
        }

        // é»æ“Šäº’å‹•
        moon.addEventListener('click', doSheng);
        shakeArea.addEventListener('click', doSheng);

        // CSS å‹•ç•«è£œä¸Š
        const style = document.createElement('style');
        style.innerHTML = `
            .shake-animation {
                animation: shakeMoon 0.4s cubic-bezier(0.2, 0.9, 0.3, 1.1) !important;
            }
            @keyframes shakeMoon {
                0% { transform: rotate(0deg); }
                25% { transform: rotate(25deg); }
                50% { transform: rotate(-25deg); }
                75% { transform: rotate(15deg); }
                100% { transform: rotate(0deg); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>