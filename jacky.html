<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <!-- æ‰‹æ©Ÿå¼·åˆ¶é–å®š but æ–æ™ƒå¤§é–‹ï¼æ–æ‰‹æ©Ÿæœ‰ç”¨ç‰ˆ -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover, shrink-to-fit=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Jacky Â· æ–æ‰‹æ©Ÿ Â· çµ•å°æœ‰ç”¨æ“²ç­Š</title>
    <style>
        /* ç¡¬æ´¾é‡ç½®ï¼šæ‰€æœ‰è§¸ç¢°è¡Œç‚ºå°å‘æ–æ™ƒ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            -webkit-user-select: none;
            -webkit-touch-callout: none;
        }
        body {
            background: #1e130b;
            font-family: "Noto Serif TC", "æ¨™æ¥·é«”", "DFKai-SB", "PingFang TC", "Helvetica Neue", sans-serif;
            overflow: hidden;
            height: 100vh;
            width: 100vw;
            position: fixed;
            overscroll-behavior: none;
            touch-action: pan-x pan-y; /* åƒ…ä¿ç•™éå¸¸åŸºæœ¬å¹³ç§»ï¼Œç„¡ç¸®æ”¾ */
        }
        /* ----- å…¥å£ç•«é¢ Jacky æ°£å‹¢ ----- */
        .splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 35% 40%, #5a3820, #1e130a);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 300;
            transition: opacity 1.2s ease, visibility 1.2s;
            color: #ffecb3;
            text-shadow: 0 0 40px #ffaa11;
            padding: 20px;
            border-bottom: 12px solid #e5a951;
            box-shadow: 0 0 100px #ffaa00;
        }
        .splash-logo {
            font-size: min(140px, 26vw);
            margin-bottom: 5px;
            filter: drop-shadow(0 0 50px #ffcc22);
            animation: swing 2s infinite alternate;
        }
        @keyframes swing {
            0% { transform: rotate(-10deg); }
            100% { transform: rotate(10deg); }
        }
        .splash-title {
            font-size: min(74px, 15vw);
            font-weight: 900;
            letter-spacing: 0.25em;
            color: #ffeaa8;
            text-shadow: 6px 6px 0 #7a451e;
            margin-top: 0;
            text-align: center;
        }
        .splash-name {
            font-size: min(54px, 11vw);
            background: #e8a84a;
            color: #1e1206;
            padding: 14px 1.2em;
            border-radius: 80px;
            border: 6px solid #ffdd33;
            box-shadow: 0 0 70px #ffdd44;
            margin: 30px 0 20px;
            font-weight: 900;
            letter-spacing: 0.4em;
            white-space: nowrap;
            width: 90%;
            max-width: 620px;
            text-align: center;
        }
        .enter-btn {
            background: #d9983a;
            border: none;
            color: #1a1006;
            font-size: min(48px, 11vw);
            font-weight: 900;
            padding: 0.6em 1.8em;
            border-radius: 120px;
            letter-spacing: 0.4em;
            box-shadow: 0 0 70px #ffcc33;
            border-bottom: 10px solid #714e1a;
            cursor: pointer;
            transition: 0.05s linear;
            margin-top: 30px;
            text-shadow: 3px 3px 0 #ffdd77;
            width: 80%;
            max-width: 550px;
            -webkit-appearance: none;
            font-family: inherit;
        }
        .enter-btn:active {
            border-bottom-width: 4px;
            transform: translateY(8px);
            background: #eead4a;
        }

        /* ----- 3D å ´æ™¯å®¹å™¨ ----- */
        .main-scene {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            opacity: 0;
            transition: opacity 2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        .show-scene {
            opacity: 1 !important;
        }

        /* ----- å¤§å¤§æ‹œæ‹œå›‰ ----- */
        .worship-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #ffeaa0;
            font-size: min(70px, 13vw);
            font-weight: 900;
            text-shadow: 0 0 45px #ff6600, 0 0 100px #ffaa33, 6px 6px 0 #5a281e;
            letter-spacing: 0.2em;
            white-space: nowrap;
            z-index: 30;
            opacity: 0.2;
            pointer-events: none;
            border: 8px double #ffbb44;
            padding: 0.5em 1.3em;
            border-radius: 130px;
            background: rgba(50, 22, 5, 0.5);
            backdrop-filter: blur(8px);
            animation: worshipPulse 3s infinite;
        }
        @keyframes worshipPulse {
            0% { opacity: 0.2; border-color: #ffaa33; }
            50% { opacity: 0.45; border-color: #ffdd77; text-shadow: 0 0 60px #ffaa00; }
            100% { opacity: 0.2; border-color: #ffaa33; }
        }

        /* ----- é£›é¦¬å¹´è³€è© æ»¿å¤©é£› ----- */
        .greeting-sky {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 25;
            overflow: hidden;
        }
        .greet {
            position: absolute;
            font-size: min(38px, 8vw);
            font-weight: 800;
            white-space: nowrap;
            opacity: 0;
            animation: flyAcross 16s linear infinite;
            background: linear-gradient(145deg, #fff7cf, #ffdb7c);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px #ff8c1a;
            letter-spacing: 0.25em;
            z-index: 26;
        }
        @keyframes flyAcross {
            0% { opacity: 0.8; transform: translateX(100vw) translateY(0) rotate(15deg); }
            25% { opacity: 1; }
            75% { opacity: 0.9; }
            100% { opacity: 0; transform: translateX(-40vw) translateY(-25vh) rotate(-15deg); }
        }
        .g01 { top: 8%; left: 2%; animation-delay: 0.1s; }
        .g02 { top: 28%; left: 12%; animation-delay: 2.2s; }
        .g03 { top: 60%; left: 7%; animation-delay: 4.0s; }
        .g04 { top: 15%; left: 75%; animation-delay: 1.8s; }
        .g05 { top: 50%; left: 40%; animation-delay: 5.5s; }
        .g06 { top: 75%; left: 25%; animation-delay: 2.9s; }
        .g07 { top: 5%; left: 55%; animation-delay: 6.3s; }
        .g08 { top: 45%; left: 80%; animation-delay: 7.2s; }
        .g09 { top: 22%; left: 88%; animation-delay: 1.5s; }
        .g10 { top: 82%; left: 68%; animation-delay: 4.9s; }

        /* ----- æ–æ“²æ¯ç‰¹å¤§é¢æ¿ Â· æ–æ‰‹æ©Ÿçµ•å°æœ‰ç”¨å€ ----- */
        .divination-box {
            position: fixed;
            bottom: 20px;
            left: 15px;
            right: 15px;
            width: auto;
            background: rgba(30, 16, 5, 0.97);
            backdrop-filter: blur(16px);
            border: 4px solid #e6b445;
            border-radius: 60px 60px 40px 40px;
            padding: 22px 18px;
            color: #fff6d0;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
            z-index: 60;
            box-shadow: 0 0 60px rgba(255, 120, 0, 0.9);
            border-top: 12px solid #ffcc55;
            pointer-events: auto;
            transition: opacity 1.2s, transform 0.2s;
            max-width: 540px;
            margin: 0 auto;
        }
        .jacky-sign {
            font-size: min(30px, 7vw);
            background: #b87a3a;
            padding: 12px 20px;
            border-radius: 60px;
            color: #fffbe3;
            letter-spacing: 0.3em;
            font-weight: 900;
            border: 3px solid #ffdd99;
            text-shadow: 2px 2px 0 #4e2a10;
            width: 100%;
            text-align: center;
        }
        .moon-icons {
            font-size: min(100px, 22vw);
            line-height: 1.2;
            filter: drop-shadow(0 0 30px #ffbb33);
            background: #311f12;
            padding: 12px 35px;
            border-radius: 120px;
            border: 5px solid #ffcc44;
            transition: transform 0.08s; /* æ–æ™ƒå‹•ç•«åŠ é€Ÿ */
        }
        .shake-animation {
            animation: shakeHard 0.3s cubic-bezier(0.25, 0.1, 0.25, 1) !important;
        }
        @keyframes shakeHard {
            0% { transform: rotate(0deg); }
            15% { transform: rotate(35deg); }
            35% { transform: rotate(-35deg); }
            55% { transform: rotate(25deg); }
            70% { transform: rotate(-20deg); }
            85% { transform: rotate(10deg); }
            100% { transform: rotate(0deg); }
        }
        .result-card {
            font-size: min(28px, 6.8vw);
            background: #4d2b16;
            padding: 20px 16px;
            border-radius: 50px;
            text-align: center;
            color: #fffad4;
            border: 4px solid #ffbb44;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            width: 100%;
            font-weight: 700;
            word-break: break-word;
            box-shadow: inset 0 0 20px #704d25;
        }
        
        /* ----- æ–æ™ƒæç¤ºè¶…æš´åŠ› å¯«ã€Œæ–æ‰‹æ©Ÿçµ•å°æœ‰ç”¨ã€ ----- */
        .shake-hint {
            position: fixed;
            top: 18%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 200, 20, 0.95);
            color: #2d1706;
            font-size: min(40px, 9vw);
            font-weight: 900;
            padding: 18px 36px;
            border-radius: 70px;
            border: 6px solid #ffaa22;
            box-shadow: 0 0 80px #ffaa00;
            z-index: 150;
            white-space: nowrap;
            letter-spacing: 10px;
            backdrop-filter: blur(10px);
            animation: pulseStrong 1.2s infinite alternate;
            pointer-events: none;
            text-shadow: 3px 3px 0 #ffee88;
        }
        @keyframes pulseStrong {
            from { transform: translateX(-50%) scale(1); background: #ffcc22; }
            to { transform: translateX(-50%) scale(1.18); background: #ffb422; }
        }

        .music-control {
            position: fixed;
            top: 15px;
            right: 15px;
            background: rgba(10,5,2,0.85);
            backdrop-filter: blur(12px);
            border: 3px solid #ffaa33;
            border-radius: 80px;
            padding: 12px 20px;
            color: white;
            font-size: min(30px, 7vw);
            z-index: 250;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 0 35px #ff9900;
            pointer-events: auto;
        }
        .music-btn {
            background: none;
            border: none;
            color: #ffe185;
            font-size: min(34px, 7vw);
            cursor: pointer;
            padding: 6px 14px;
            -webkit-appearance: none;
            font-weight: bold;
        }
        .lantern-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 15% 30%, rgba(255, 180, 40, 0.12) 0%, transparent 70%);
            pointer-events: none;
            z-index: 8;
        }
        #hint-text {
            position: fixed;
            bottom: 15px;
            left: 15px;
            color: #ffefd1;
            background: rgba(80, 40, 5, 0.9);
            padding: 10px 24px;
            border-radius: 60px;
            backdrop-filter: blur(3px);
            border: 2px solid #e6b45a;
            font-size: min(22px, 5.5vw);
            letter-spacing: 0.3em;
            z-index: 55;
            pointer-events: none;
        }
        /* æŠŠã€Œæ–æ‰‹æ©Ÿæ²’ç”¨ã€è®Šæˆã€Œæ–æ‰‹æ©Ÿä¿è­‰æœ‰ç”¨ã€ç²¾ç¥ */
        .useless-stamp {
            display: none;
        }
    </style>
</head>
<body>

    <!-- éŸ³æ¨‚æ§åˆ¶ (é è¨­éš±è—å…¥å»Ÿå¾Œé¡¯ç¤º) -->
    <div id="musicControl" class="music-control" style="opacity:0; transition:opacity 1s; pointer-events:none;">
        <span>ğŸ´ Jacky å¹´</span>
        <button id="toggleMusicBtn" class="music-btn" style="pointer-events:auto;">ğŸ”Š é–‹</button>
    </div>

    <!-- å…¥å£å»Ÿé–€ Â· Jacky éµç²‰è¿è³“ -->
    <div id="splashScreen" class="splash-screen">
        <div class="splash-logo">ğŸ¯ğŸ´ğŸ¥¢ğŸ‹</div>
        <div class="splash-title">é¦¬å¹´æ“²ç­Š</div>
        <div class="splash-name">Jacky æœ‰ç”¨æ–</div>
        <div style="font-size: min(36px, 8vw); margin: 20px 0; color: #ffdd77; text-align:center; background: #3f281a; padding: 8px 30px; border-radius: 60px; box-shadow: inset 0 0 20px #ffaa22;">
            ğŸ“³ æ–æ‰‹æ©Ÿ Â· çµ•å°è§¸ç™¼ ğŸ“³
        </div>
        <button id="enterBtn" class="enter-btn">å…¥å»Ÿé–‹æ–</button>
        <div style="font-size: min(24px, 5vw); margin-top: 30px; color: #efc48c;">â€”â€” Jacky ä¿è­‰æ–å°±æœ‰ç­Š â€”â€”</div>
    </div>

    <!-- 3D å»Ÿå®‡ç•«å¸ƒå®¹å™¨ -->
    <div id="mainSceneContainer" class="main-scene">
        <div id="info3d" style="position: absolute; top: 15px; left: 15px; background: rgba(80, 40, 8, 0.9); padding: 10px 25px; border-radius: 60px; border-left: 12px solid #ffcc44; color: #fff7cf; font-size: min(26px, 6vw); backdrop-filter: blur(6px); z-index: 45; box-shadow: 0 0 40px #bb7700; pointer-events: none; white-space: nowrap;">
            ğŸ <span style="font-weight:900;">Jacky æœ‰ç”¨æ– Â· é¦¬å¹´ç™¼è²¡</span> ç«‹å³æ–
        </div>
    </div>

    <!-- æ‹œæ‹œå›‰ è¶…å¤§å­— (ç¶­æŒé¢¨æ ¼) -->
    <div id="worshipBig" class="worship-message">ğŸ™ æ‹œæ‹œæ–æ“²ç­Š ğŸ™</div>

    <!-- æ¼«å¤©é¦¬å¹´è³€è© (Jacky è¦ªç­†) -->
    <div id="greetingLayer" style="opacity: 0; transition: opacity 2.2s;">
        <div class="greeting-sky">
            <div class="greet g01">ğŸ´ æ–æ‰‹æ©Ÿ Â· Jacky ç¥æ‚¨ç™¼è²¡</div>
            <div class="greet g02">ğŸ® æœ‰ç”¨æ–ï¼ æ“²ç­Šè–æ¯</div>
            <div class="greet g03">ğŸ’° é¦¬åˆ°æˆåŠŸ Â· è²¡é‹çˆ†æ£š</div>
            <div class="greet g04">ğŸ™ ç­Šæ¯è–æ„ Â· æ–å°±æœ‰</div>
            <div class="greet g05">âœ¨ é‡‘é¦¬æ–ç¦ Â· Jacky è³œæ¯</div>
            <div class="greet g06">ğŸŒ¸ é¦¬å¹´è¡Œå¤§é‹ Â· æ–å‡ºå¥½é‹</div>
            <div class="greet g07">ğŸ‹ æ­¥æ­¥é«˜å‡ Â· ä¸€é¦¬ç•¶å…ˆ</div>
            <div class="greet g08">ğŸŠ å¤§å‰å¤§åˆ© Â· æ–æ–æ¨‚</div>
            <div class="greet g09">ğŸ‡ ç­–é¦¬æšé­ Â· æ–å‡ºå‰ç¨‹</div>
            <div class="greet g10">ğŸŠ äº”ç¦è‡¨é–€ Â· Jacky æ–æ»¾</div>
        </div>
    </div>

    <!-- æ“²ç›ƒäº’å‹•æˆ°å€ï¼šæ–æ‰‹æ©Ÿçµ•å°æœ‰ç”¨ -->
    <div id="divinationUI" style="opacity: 0; transition: opacity 1.8s; pointer-events: none;">
        <div class="divination-box">
            <div class="jacky-sign">Jacky æœ‰ç”¨æ– Â· ä¿è­‰ç­Šæ¯</div>
            <div id="moonDisplay" class="moon-icons">ğŸ¥¢ğŸ¥¢</div>
            <div id="resultMessage" class="result-card">æº–å‚™å¥½å°±æ–æ‰‹æ©Ÿï¼ç«‹å³æ“²ç­Š</div>
            <div style="font-size: min(26px, 6vw); color: #ffe9ad; display: flex; align-items: center; justify-content: center; gap: 15px; background: #2f1e10; padding: 8px 20px; border-radius: 60px; border:2px solid #ffbb33;">
                <span>ğŸ“³ æ– Â· å°±æœ‰</span> <span style="font-size:40px;">ğŸ”„</span> <span>ä¿è­‰è§¸ç™¼</span>
            </div>
        </div>
    </div>

    <!-- è¶…é†’ç›®æç¤º: æ–æ‰‹æ©Ÿæœ‰ç”¨ï¼ ä¸æ˜¯è£é£¾ -->
    <div id="shakeHint" class="shake-hint" style="opacity:0; transition: opacity 0.7s;">ğŸ“³ æ–æ‰‹æ©Ÿ Â· å³åˆ»æ“²ç­Š ğŸ“³</div>

    <div class="lantern-bg"></div>
    <div id="hint-text" style="opacity: 0;">ğŸ¥¢ Jacky æ–æ“²ç­Š Â· é¦¬å¹´éˆé©— ğŸ</div>

    <!-- èƒŒæ™¯éŸ³æ¨‚ (GitHub horse.mp3) -->
    <audio id="bgMusic" loop preload="auto" style="display: none;">
        <source src="https://raw.githubusercontent.com/Sethjesus/newyear/main/horse.mp3" type="audio/mpeg">
    </audio>

    <!-- è¼‰å…¥ Three.js ä¸¦æº–å‚™å»Ÿå®‡ -->
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.128.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.128.0/examples/jsm/"
            }
        }
    </script>

    <script type="module">
        // ----- 3D å ´æ™¯ æ‰‹æ©Ÿæ¥µç°¡å»Ÿå®‡ (æ•ˆèƒ½å„ªå…ˆ) -----
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
        import { CSS2DRenderer, CSS2DObject } from 'three/addons/renderers/CSS2DRenderer.js';

        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x1f130c);
        
        const camera = new THREE.PerspectiveCamera(48, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(5.8, 3.8, 11.5);
        camera.lookAt(0, 1.3, 0);
        
        const renderer = new THREE.WebGLRenderer({ antialias: true, powerPreference: "high-performance" });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.shadowMap.enabled = true;
        renderer.shadowMap.type = THREE.PCFSoftShadowMap;
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        
        const labelRenderer = new CSS2DRenderer();
        labelRenderer.setSize(window.innerWidth, window.innerHeight);
        labelRenderer.domElement.style.position = 'absolute';
        labelRenderer.domElement.style.top = '0px';
        labelRenderer.domElement.style.left = '0px';
        labelRenderer.domElement.style.pointerEvents = 'none';
        
        const mainContainer = document.getElementById('mainSceneContainer');
        mainContainer.appendChild(renderer.domElement);
        mainContainer.appendChild(labelRenderer.domElement);
        
        const controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.06;
        controls.autoRotate = true;
        controls.autoRotateSpeed = 0.7;
        controls.enableZoom = true;
        controls.enablePan = true;
        controls.enableRotate = true;
        controls.enableTouchRotate = true;
        controls.target.set(0, 1.3, 0);
        controls.maxPolarAngle = Math.PI / 2.3;
        controls.minDistance = 7;
        controls.maxDistance = 22;
        
        // ç‡ˆå…‰èˆ‡ç°¡æ˜“å»Ÿæ®¿
        const ambient = new THREE.AmbientLight(0x5e4a3a);
        scene.add(ambient);
        const mainLight = new THREE.DirectionalLight(0xffeedd, 1.0);
        mainLight.position.set(4, 8, 9);
        mainLight.castShadow = true;
        mainLight.receiveShadow = true;
        scene.add(mainLight);
        
        const ground = new THREE.Mesh(
            new THREE.CircleGeometry(13, 16),
            new THREE.MeshStandardMaterial({ color: 0x6b4f3c, roughness: 0.9 })
        );
        ground.rotation.x = -Math.PI / 2;
        ground.position.y = -0.02;
        ground.receiveShadow = true;
        scene.add(ground);
        
        const base = new THREE.Mesh(
            new THREE.BoxGeometry(6.0, 0.3, 5.2),
            new THREE.MeshStandardMaterial({ color: 0x8a6b4b, roughness: 0.7 })
        );
        base.position.set(0, 0.15, 0);
        base.castShadow = true;
        base.receiveShadow = true;
        scene.add(base);
        
        const wall = new THREE.Mesh(
            new THREE.BoxGeometry(5.2, 1.7, 4.4),
            new THREE.MeshStandardMaterial({ color: 0xb77a3c, roughness: 0.65 })
        );
        wall.position.set(0, 1.05, 0);
        wall.castShadow = true;
        wall.receiveShadow = true;
        scene.add(wall);
        
        const roof = new THREE.Mesh(
            new THREE.ConeGeometry(4.0, 0.95, 4),
            new THREE.MeshStandardMaterial({ color: 0xcc8833, roughness: 0.55 })
        );
        roof.position.set(0, 1.95, 0);
        roof.rotation.y = Math.PI/4;
        roof.castShadow = true;
        roof.receiveShadow = true;
        scene.add(roof);
        
        const lanternMat = new THREE.MeshStandardMaterial({ color: 0xd84c3c, emissive: 0x3a1e1e, emissiveIntensity: 0.25 });
        const posL = [[-1.6, 1.7, 1.6], [1.6, 1.7, 1.6], [0, 1.9, 1.6]];
        posL.forEach(p => {
            const l = new THREE.Mesh(new THREE.SphereGeometry(0.27), lanternMat);
            l.position.set(p[0], p[1], p[2]);
            l.castShadow = true;
            scene.add(l);
        });
        
        const div = document.createElement('div');
        div.textContent = 'ğŸ´ Jacky æœ‰ç”¨æ–è–å»Ÿ ğŸ´';
        div.style.color = '#ffdb8b';
        div.style.fontSize = '26px';
        div.style.fontWeight = '900';
        div.style.background = 'rgba(160,70,15,0.9)';
        div.style.padding = '8px 28px';
        div.style.borderRadius = '60px';
        div.style.border = '5px solid #ffcc44';
        div.style.letterSpacing = '8px';
        div.style.whiteSpace = 'nowrap';
        const label = new CSS2DObject(div);
        label.position.set(0, 2.6, 1.3);
        scene.add(label);
        
        const burner = new THREE.Mesh(
            new THREE.CylinderGeometry(0.75, 0.85, 0.2, 16),
            new THREE.MeshStandardMaterial({ color: 0x5a4734 })
        );
        burner.position.set(0, 0.3, 0.95);
        burner.castShadow = true;
        burner.receiveShadow = true;
        scene.add(burner);
        
        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
            labelRenderer.render(scene, camera);
        }
        animate();
        
        window.addEventListener('resize', onWindowResize, false);
        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
            labelRenderer.setSize(window.innerWidth, window.innerHeight);
        }

        // ---------- æ–æ‰‹æ©Ÿçµ•å°æœ‰ç”¨å€ Â· Jacky å¼·åŠ›æ–æ™ƒåµæ¸¬ ----------
        const splash = document.getElementById('splashScreen');
        const mainSceneDiv = document.getElementById('mainSceneContainer');
        const worshipEl = document.getElementById('worshipBig');
        const greetingWrap = document.getElementById('greetingLayer');
        const divinationUI = document.getElementById('divinationUI');
        const hintEl = document.getElementById('hint-text');
        const musicControl = document.getElementById('musicControl');
        const enterBtn = document.getElementById('enterBtn');
        const audio = document.getElementById('bgMusic');
        const toggleBtn = document.getElementById('toggleMusicBtn');
        const shakeHint = document.getElementById('shakeHint');
        const moonDisplay = document.getElementById('moonDisplay');
        const resultMsg = document.getElementById('resultMessage');
        
        let isMusicPlaying = false;
        let sceneActive = false; // å…¥å»Ÿå¾Œæ‰é–‹å§‹æ–æ“²ç­Š

        // ---------- å…¥å»Ÿå•Ÿå‹• ----------
        enterBtn.addEventListener('click', () => {
            splash.style.opacity = '0';
            splash.style.visibility = 'hidden';
            
            mainSceneDiv.classList.add('show-scene');
            worshipEl.style.opacity = '0.3';
            greetingWrap.style.opacity = '1';
            divinationUI.style.opacity = '1';
            divinationUI.style.pointerEvents = 'auto';
            hintEl.style.opacity = '1';
            musicControl.style.opacity = '1';
            musicControl.style.pointerEvents = 'auto';
            shakeHint.style.opacity = '1';
            sceneActive = true;
            
            audio.play().then(() => {
                isMusicPlaying = true;
                toggleBtn.textContent = 'ğŸ”Š é—œ';
            }).catch(e => {
                console.log('éœ€è§¸æ‘¸å•Ÿå‹•éŸ³æ¨‚', e);
                isMusicPlaying = false;
                toggleBtn.textContent = 'ğŸ”‡ é–‹';
            });
        });
        
        // éŸ³æ¨‚é–‹é—œ
        toggleBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            if (isMusicPlaying) {
                audio.pause();
                toggleBtn.textContent = 'ğŸ”‡ é–‹';
            } else {
                audio.play().then(() => {
                    toggleBtn.textContent = 'ğŸ”Š é—œ';
                }).catch(err => { alert('é»ç•«é¢å…è¨±éŸ³æ¨‚'); });
            }
            isMusicPlaying = !isMusicPlaying;
        });

        // ---------- ç­Šæ¯æ¸…å–® Â· æ»¿æ»¿å‰ç¥¥è©± ----------
        const fortunes = [
            { emoji: 'ğŸ¥¢ğŸ¥¢', name: 'è–ç­Š (å¤§å‰)', msg: 'ğŸ´ é¦¬å¹´å¤§ç™¼ Â· Jacky è³€' },
            { emoji: 'ğŸŒ™ğŸ¥¢', name: 'ç¬‘ç­Š (æ­¡å–œ)', msg: 'ğŸ® é¾é¦¬ç²¾ç¥ Â· æ–å‡ºå¥½é‹' },
            { emoji: 'ğŸ¥¢ğŸŒ™', name: 'é™°ç­Š (è²´äºº)', msg: 'ğŸ™ æ–æ“²ç­Š Â· è²´äººç›¸åŠ©' },
            { emoji: 'ğŸ¥¢ğŸ¥¢', name: 'è–ç­Š (ç™¼è²¡)', msg: 'ğŸ’° é¦¬åˆ°æˆåŠŸ Â· è²¡æºæ»¾æ»¾' },
            { emoji: 'ğŸŒ™ğŸŒ™', name: 'ç¬‘ç­Š (å¦‚æ„)', msg: 'âœ¨ é‡‘é¦¬æ–ç¦ Â· Jacky è³œç¦' },
            { emoji: 'ğŸŒ™ğŸ¥¢', name: 'è–ç­Š (é›™å–œ)', msg: 'ğŸŒ¸ é¦¬å¹´å¦‚æ„ Â· å¥½äº‹æˆé›™' },
            { emoji: 'ğŸ¥¢ğŸŒ™', name: 'é™°ç­Š (å¹³å®‰)', msg: 'ğŸ•¯ï¸ å¿ƒèª å‰‡éˆ Â· äº‹äº‹é †å¿ƒ' }
        ];

        let lastShakeTimestamp = 0;
        let shakeLock = false; // å†·å»

        // ***** æ–æ‰‹æ©Ÿæ“²ç­Šï¼šçµ•å°æœƒè§¸ç™¼ï¼Œè¶…ç´šéˆæ• *****
        function throwBwa() {
            if (!sceneActive) return;
            if (shakeLock) return; // é˜²æ­¢800mså…§é€£çºŒçˆ†è¡
            
            shakeLock = true;
            
            // ç­Šæ¯æš´åŠ›æ–æ™ƒå‹•ç•«
            moonDisplay.classList.add('shake-animation');
            setTimeout(() => {
                moonDisplay.classList.remove('shake-animation');
            }, 400);
            
            // éš¨æ©Ÿçµæœ
            const idx = Math.floor(Math.random() * fortunes.length);
            const cup = fortunes[idx];
            moonDisplay.textContent = cup.emoji;
            resultMsg.innerHTML = `<span style="font-size:1.3em; font-weight:900;">${cup.name}</span><br><span style="font-size:1.1em; letter-spacing:0.15em;">${cup.msg}</span>`;
            
            // æ¯æ¬¡æ–æ“²ç­Šï¼Œå°±åœ¨å¤©ç©ºæ–°å¢ä¸€é“Jackyç¥è³€ (å¢åŠ æœ‰æ„Ÿ)
            const newGreet = document.createElement('div');
            newGreet.className = 'greet';
            newGreet.style.animation = 'flyAcross 14s linear';
            newGreet.style.left = Math.random() * 70 + '%';
            newGreet.style.top = Math.random() * 80 + '%';
            newGreet.style.fontSize = 'min(46px, 10vw)';
            newGreet.textContent = 'ğŸ¥¢ Jacky æœ‰ç”¨æ– Â· è–ç­Š '+ (cup.name.includes('è–')?'âœ…':'âœ¨');
            document.querySelector('.greeting-sky')?.appendChild(newGreet);
            setTimeout(() => newGreet.remove(), 14000);
            
            // æ–æ™ƒæç¤ºé–ƒçˆå¨æ­¦
            shakeHint.style.animation = 'none';
            shakeHint.offsetHeight;
            shakeHint.style.animation = 'pulseStrong 0.9s infinite alternate';
            
            // å†·å»æ™‚é–“ 750msï¼Œé¿å…é€£æ–éå¯†ï¼Œä½†ä¾ç„¶ä¿æŒã€Œæ–å¾ˆæœ‰ç”¨ã€
            setTimeout(() => {
                shakeLock = false;
            }, 750);
        }

        // ---------- æ¥µè‡´æ–æ™ƒåµæ¸¬ Â· ä½é–€æª» Â· ä¿è­‰è§¸ç™¼ ----------
        if (window.DeviceMotionEvent) {
            window.addEventListener('devicemotion', function(event) {
                if (!sceneActive) return; // æœªå…¥å»Ÿä¸æ–æ“²ç­Š
                
                const acc = event.accelerationIncludingGravity;
                if (!acc) return;
                
                const now = Date.now();
                // å†·å»æª¢æ ¸ (ä½†ç¶­æŒè§¸ç™¼é »ç‡å¤ é«˜)
                if (now - lastShakeTimestamp < 900) return; 
                
                const x = Math.abs(acc.x || 0);
                const y = Math.abs(acc.y || 0);
                const z = Math.abs(acc.z || 0);
                
                // é–¾å€¼é™ä½ï¼ 9.5 å°±æ–ï¼ ç¸½å’Œå¤§æ–¼23ï¼Œè®“æ–æ‰‹æ©Ÿã€Œéå¸¸æœ‰ç”¨ã€
                if ( (x > 9.5 || y > 9.5 || z > 9.5) && (x + y + z > 23) ) {
                    lastShakeTimestamp = now;
                    throwBwa();
                    
                    // éœ‡å‹•ä¸€ä¸‹ (æœ‰ç”¨æ–å¯¦æ„Ÿ)
                    if (navigator.vibrate) {
                        navigator.vibrate(35);
                    }
                }
            }, false);
        } else {
            // å¦‚æœæ²’æœ‰é™€èºå„€ï¼Œé»æ“Šç­Šæ¯ä¹Ÿèƒ½æ“²ç­Š (å‚™ç”¨)
            moonDisplay.addEventListener('click', function() {
                if (sceneActive) throwBwa();
            });
        }

        // å¼·åˆ¶æ‰‹æ©Ÿè§¸ç¢°ä¸ç¸®æ”¾
        document.addEventListener('touchmove', (e) => { if (e.scale !== 1) e.preventDefault(); }, { passive: false });
        
        // å†åŠ é»æ“Šæ“²ç­Šè¼”åŠ©(ä½†æˆ‘å€‘ä¸»è»¸æ˜¯æ–)
        moonDisplay.addEventListener('click', function() {
            if (sceneActive) throwBwa();
        });
        
        // æç¤º: æ–æ‰‹æ©Ÿå°±å°å•¦!
        console.log('æ–æ‰‹æ©Ÿçµ•å°æœ‰ç”¨ç‰ˆ Â· Jacky æ“²ç­Š');
    </script>
</body>
</html>