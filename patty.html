<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <!-- æ‰‹æ©Ÿå‹å–„ Â· ç«‹é«”è–ç­Šå‹•æ„Ÿ Â· å¥‰å¤©å®® Â· Pattyå®Œæ•´ç¥ç¦ -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5, user-scalable=yes, viewport-fit=cover">
    <title>Patty Â· ESGå®® Â· ç«‹é«”è–ç­Š</title>
    <style>
        /* ********** åŸºåº•å®Œå…¨éœæ­¢ï¼Œåªæœ‰è–ç­Šç¬é–“ç«‹é«”å‹•ç•« ********** */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #7f321e;
            font-family: "Noto Serif TC", "æ¨™æ¥·é«”", "PingFang TC", sans-serif;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            position: relative;
        }

        /* ------------- ä¸»ç´…åŒ… Â· å®Œå…¨éœæ­¢ ------------- */
        .red-card {
            background: #c43c1e;
            max-width: 580px;
            width: 100%;
            border-radius: 50px 50px 30px 30px;
            border: 10px solid #ffc56e;
            box-shadow: 0 12px 0 #6e351b;
            padding: 32px 24px;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 20;
        }

        .red-card::before {
            content: "ğŸ´ Patty ä¾†æ‹œå¹´ ğŸ´";
            position: absolute;
            top: -18px;
            left: 15%;
            width: 70%;
            background: #ffd966;
            color: #712e1a;
            font-size: min(26px, 5.5vw);
            font-weight: 900;
            text-align: center;
            padding: 10px 0;
            border-radius: 50px;
            border: 4px solid #ffa62b;
            box-shadow: 0 6px 0 #8f552a;
            letter-spacing: 6px;
            text-shadow: none;
        }

        .sheng-big {
            font-size: min(90px, 18vw);
            font-weight: 900;
            color: #fff0a5;
            text-shadow: 6px 6px 0 #64281a;
            line-height: 1;
            margin-top: 20px;
            margin-bottom: 8px;
        }

        /* ------------- ç­Šæ¯å€ Â· ç«‹é«”å‹•æ„Ÿä¿ç•™ ------------- */
        .bwa-panel {
            background: #2d1a0e;
            border: 6px solid #ff9f2f;
            border-radius: 70px 70px 30px 30px;
            padding: 26px 22px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 16px;
            max-width: 580px;
            width: 100%;
            margin-top: 20px;
            box-shadow: 0 12px 0 #54381e;
            border-top: 8px solid #ffb84d;
            perspective: 800px; /* æä¾›ç«‹é«”ç¿»è½‰æ™¯æ·± */
        }

        /* è–ç­Šç«‹é«”å‹•ç•« Â· å‡ºç¾è–ç­Šæ™‚è§¸ç™¼3Dç¿»è½‰ï¼‹çªèµ· */
        .moon {
            font-size: min(120px, 22vw);
            background: #1e130c;
            padding: 8px 45px;
            border-radius: 180px;
            border: 6px solid #ffb84d;
            filter: drop-shadow(0 8px 0 #7a401a);
            line-height: 1;
            cursor: pointer;
            display: inline-block;
            transition: transform 0.2s cubic-bezier(0.28, 0.84, 0.42, 1), box-shadow 0.15s ease, border-color 0.15s;
            transform-style: preserve-3d;
        }

        /* ç«‹é«”è–ç­Šæ•ˆæœï¼šç¿»è½‰ï¼‹æµ®å‡¸ï¼‹é‡‘è‰²é–ƒçˆ */
        .moon.sheng-active {
            animation: shengPop 0.5s cubic-bezier(0.22, 1.52, 0.68, 1) forwards;
        }

        @keyframes shengPop {
            0% { transform: rotateY(0deg) scale(1); border-color: #ffb84d; filter: drop-shadow(0 8px 0 #7a401a); }
            20% { transform: rotateY(180deg) scale(1.2); border-color: #ffe480; filter: drop-shadow(0 12px 0 #a6521a); background: #352010; }
            50% { transform: rotateY(360deg) scale(1.1); border-color: #ffdd55; filter: drop-shadow(0 15px 0 #c45e1a); background: #4d2d1a; }
            80% { transform: rotateY(540deg) scale(1.05); border-color: #ffc800; filter: drop-shadow(0 10px 0 #8f3e1a); background: #2e1b10; }
            100% { transform: rotateY(720deg) scale(1); border-color: #ffb84d; filter: drop-shadow(0 8px 0 #7a401a); background: #1e130c; }
        }

        /* æ–ï¼é»æŒ‰éˆ•ä¹Ÿè¦å¾®å¾®ç«‹é«”åé¥‹ */
        .shake-btn {
            font-size: min(34px, 7vw);
            font-weight: 900;
            background: #3f281a;
            color: #ffdc8a;
            padding: 12px 28px;
            border-radius: 70px;
            border: 4px solid #ff9f2f;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
            cursor: pointer;
            border-bottom: 8px solid #614124;
            transition: transform 0.08s, border-bottom 0.08s;
        }
        .shake-btn:active {
            transform: translateY(4px);
            border-bottom-width: 4px;
        }

        .result-line {
            font-size: min(36px, 7.5vw);
            font-weight: 900;
            color: #ffeeb0;
            background: #412e1e;
            padding: 14px 24px;
            border-radius: 60px;
            border: 4px solid #ffa62b;
            text-align: center;
            width: 100%;
            letter-spacing: 4px;
            transition: text-shadow 0.2s;
        }

        /* ------------- ç¥ç¦è¨Šæ¯å€ ------------- */
        .bless-message-area {
            width: 100%;
            max-width: 580px;
            min-height: 100px;
            background: #2f1e14;
            border: 4px solid #ffa52f;
            border-radius: 50px;
            margin-top: 25px;
            padding: 20px 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff6cf;
            font-size: min(32px, 6.8vw);
            font-weight: 900;
            text-align: center;
            word-break: break-word;
            letter-spacing: 4px;
            line-height: 1.4;
            box-shadow: inset 0 0 0 2px #734d2a;
        }

        /* ------------- å¥‰å¤©å®® 3D ------------- */
        .temple-box {
            width: 100%;
            max-width: 580px;
            height: 220px;
            border-radius: 40px;
            overflow: hidden;
            border: 6px solid #ff9f2f;
            margin-top: 20px;
            background: #1e130e;
            position: relative;
        }
        .temple-title {
            position: absolute;
            bottom: 10px;
            right: 20px;
            background: rgba(0,0,0,0.7);
            color: #ffd966;
            padding: 6px 18px;
            border-radius: 40px;
            font-size: min(20px, 4.5vw);
            font-weight: 900;
            letter-spacing: 6px;
            border: 2px solid #ffaa33;
            z-index: 30;
            pointer-events: none;
        }
        #templeCanvas {
            width: 100%;
            height: 100%;
            display: block;
        }

        /* ------------- éŸ³æ¨‚åˆ— ------------- */
        .music-row {
            background: #1e130c;
            border: 4px solid #ff9f2f;
            border-radius: 70px;
            padding: 12px 22px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            max-width: 580px;
            width: 100%;
            margin-top: 18px;
        }
        .music-btn {
            background: #ffaa33;
            border: none;
            color: #2f1a0a;
            font-size: min(32px, 6.5vw);
            font-weight: bold;
            padding: 8px 26px;
            border-radius: 60px;
            border-bottom: 6px solid #7a4c26;
            cursor: pointer;
            transition: transform 0.06s;
        }
        .music-btn:active {
            transform: translateY(4px);
            border-bottom-width: 2px;
        }
        .footer-note {
            font-size: min(22px, 5vw);
            color: #ffcf8a;
            margin-top: 25px;
            letter-spacing: 8px;
            text-shadow: 2px 2px 0 #3a1c0e;
        }
    </style>
</head>
<body>

    <!-- ä¸»ç´…åŒ… -->
    <div class="red-card">
        <div class="sheng-big">è–ç­Š</div>
        <div style="font-size: min(44px, 10vw); color: #ffecaa; text-shadow: 4px 4px 0 #5e2a1a;">
            ğŸ´ğŸ§§ğŸ¥¢
        </div>
    </div>

    <!-- ç­Šæ¯äº’å‹•å€ Â· ç«‹é«”å‹•æ„Ÿä¸»è¦åœ¨æ­¤ -->
    <div class="bwa-panel">
        <div id="moonDisplay" class="moon">ğŸ¥¢ğŸ¥¢</div>
        <div id="resultMessage" class="result-line">ğŸ¥¢ Patty ç¥è–ç­Š</div>
        <div id="shakeArea" class="shake-btn">
            <span>ğŸ“³</span>
            <span>ğŸ¥¢</span>
            <span>æ– / é» è–ç­Š</span>
            <span>ğŸ¥¢</span>
        </div>
    </div>

    <!-- ç¥ç¦è©é¡¯ç¤ºå€ Â· æ¯æ¬¡æ“²ç­Šæ›´æ–°å®Œæ•´Pattyç¥ç¦ -->
    <div id="blessDisplay" class="bless-message-area">
        ğŸ´ æ–æ‰‹æ©Ÿ Â· å¾—è–ç­Š Â· Patty ç¥æ‚¨é¦¬å¹´å¤§å‰
    </div>

    <!-- 3D ESGå®® -->
    <div class="temple-box">
        <canvas id="templeCanvas"></canvas>
        <div class="temple-title">ğŸ¯ ESGå®®</div>
    </div>

    <!-- éŸ³æ¨‚æ§åˆ¶ -->
    <div class="music-row">
        <span style="font-size: min(32px, 6.5vw);">ğŸµ Patty è³€æ­²</span>
        <button id="musicToggle" class="music-btn">ğŸ”Š</button>
    </div>

    <div class="footer-note">
        ğŸ¥¢ è–ç­Š Â· ESGå®® Â· é¦¬å¹´å¤§å‰ ğŸ´
    </div>

    <!-- èƒŒæ™¯éŸ³æ¨‚ (é¦¬å¹´æ‡‰æ™¯) -->
    <audio id="bgMusic" loop preload="auto" style="display: none;">
        <source src="https://raw.githubusercontent.com/Sethjesus/newyear/main/horse.mp3" type="audio/mpeg">
    </audio>

    <!-- Three.js å¥‰å¤©å®®æ¨¡çµ„ -->
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.128.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.128.0/examples/jsm/"
            }
        }
    </script>

    <script type="module">
        // ---------- 3D ESGå®®  (å¥‰å¤©å®®é¢¨æ ¼) å®‰éœæ—‹è½‰----------
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

        const canvas = document.getElementById('templeCanvas');
        const w = canvas.clientWidth;
        const h = canvas.clientHeight;

        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x2a1a12);

        const camera = new THREE.PerspectiveCamera(45, w / h, 0.1, 1000);
        camera.position.set(5.2, 3.2, 10);
        camera.lookAt(0, 1.2, 0);

        const renderer = new THREE.WebGLRenderer({ canvas, antialias: true });
        renderer.setSize(w, h);
        renderer.shadowMap.enabled = true;
        renderer.shadowMap.type = THREE.PCFSoftShadowMap;

        // ç‡ˆå…‰
        const ambient = new THREE.AmbientLight(0x7a5a4a);
        scene.add(ambient);
        
        const mainLight = new THREE.DirectionalLight(0xffeedd, 1.2);
        mainLight.position.set(5, 8, 10);
        mainLight.castShadow = true;
        mainLight.receiveShadow = true;
        mainLight.shadow.mapSize.width = 512;
        mainLight.shadow.mapSize.height = 512;
        scene.add(mainLight);

        const fillLight = new THREE.DirectionalLight(0xffccaa, 0.5);
        fillLight.position.set(-3, 2, 5);
        scene.add(fillLight);

        // åœ°é¢
        const ground = new THREE.Mesh(
            new THREE.CircleGeometry(14, 20),
            new THREE.MeshStandardMaterial({ color: 0x6b4f3c, roughness: 0.9 })
        );
        ground.rotation.x = -Math.PI / 2;
        ground.position.y = -0.02;
        ground.receiveShadow = true;
        scene.add(ground);

        // ---------- å¥‰å¤©å®®æ®¿ Â· èŠåš´å»Ÿå®‡ ----------
        const base1 = new THREE.Mesh(
            new THREE.BoxGeometry(5.2, 0.25, 4.8),
            new THREE.MeshStandardMaterial({ color: 0x9a7a5a, roughness: 0.7 })
        );
        base1.position.set(0, 0.15, 0);
        base1.castShadow = true;
        base1.receiveShadow = true;
        scene.add(base1);

        const base2 = new THREE.Mesh(
            new THREE.BoxGeometry(4.8, 0.2, 4.4),
            new THREE.MeshStandardMaterial({ color: 0xb38b6b, roughness: 0.7 })
        );
        base2.position.set(0, 0.4, 0);
        base2.castShadow = true;
        base2.receiveShadow = true;
        scene.add(base2);

        const columnBase = new THREE.Mesh(
            new THREE.BoxGeometry(4.4, 0.2, 4.0),
            new THREE.MeshStandardMaterial({ color: 0xc69c7c, roughness: 0.6 })
        );
        columnBase.position.set(0, 0.65, 0);
        columnBase.castShadow = true;
        columnBase.receiveShadow = true;
        scene.add(columnBase);

        const columnMat = new THREE.MeshStandardMaterial({ color: 0xb87333, roughness: 0.5, emissive: 0x331e0e, emissiveIntensity: 0.1 });
        const colPos = [
            [-1.6, 1.0, 1.4], [1.6, 1.0, 1.4],
            [-1.6, 1.0, -1.4], [1.6, 1.0, -1.4]
        ];
        colPos.forEach(pos => {
            const column = new THREE.Mesh(
                new THREE.CylinderGeometry(0.18, 0.2, 1.4, 8),
                columnMat
            );
            column.position.set(pos[0], pos[1], pos[2]);
            column.castShadow = true;
            column.receiveShadow = true;
            scene.add(column);
        });

        const wall = new THREE.Mesh(
            new THREE.BoxGeometry(4.2, 1.2, 3.8),
            new THREE.MeshStandardMaterial({ color: 0xa05e3a, roughness: 0.7 })
        );
        wall.position.set(0, 1.1, 0);
        wall.castShadow = true;
        wall.receiveShadow = true;
        scene.add(wall);

        const doorMat = new THREE.MeshStandardMaterial({ color: 0x8b4513, roughness: 0.8, emissive: 0x2a1a0a, emissiveIntensity: 0.1 });
        const door = new THREE.Mesh(
            new THREE.BoxGeometry(1.2, 1.0, 0.2),
            doorMat
        );
        door.position.set(0, 0.9, 1.91);
        door.castShadow = true;
        door.receiveShadow = true;
        scene.add(door);

        const roofMat1 = new THREE.MeshStandardMaterial({ color: 0xcc8844, roughness: 0.5, emissive: 0x442211, emissiveIntensity: 0.1 });
        const roof1 = new THREE.Mesh(
            new THREE.ConeGeometry(3.8, 0.7, 4),
            roofMat1
        );
        roof1.position.set(0, 1.8, 0);
        roof1.rotation.y = Math.PI / 4;
        roof1.castShadow = true;
        roof1.receiveShadow = true;
        scene.add(roof1);

        const roofMat2 = new THREE.MeshStandardMaterial({ color: 0xbb7733, roughness: 0.5 });
        const roof2 = new THREE.Mesh(
            new THREE.ConeGeometry(3.2, 0.6, 4),
            roofMat2
        );
        roof2.position.set(0, 2.2, 0);
        roof2.rotation.y = Math.PI / 4;
        roof2.castShadow = true;
        roof2.receiveShadow = true;
        scene.add(roof2);

        const topMat = new THREE.MeshStandardMaterial({ color: 0xeeaa33, emissive: 0x553311, emissiveIntensity: 0.2 });
        const topOrb = new THREE.Mesh(
            new THREE.SphereGeometry(0.15),
            topMat
        );
        topOrb.position.set(0, 2.6, 0);
        topOrb.castShadow = true;
        scene.add(topOrb);

        const lanternMat = new THREE.MeshStandardMaterial({ color: 0xd84c3c, emissive: 0x441111, emissiveIntensity: 0.2 });
        const lanternPos = [
            [-1.6, 1.7, 1.5], [1.6, 1.7, 1.5],
            [-1.6, 1.7, -1.5], [1.6, 1.7, -1.5]
        ];
        lanternPos.forEach(pos => {
            const lantern = new THREE.Mesh(new THREE.SphereGeometry(0.18), lanternMat);
            lantern.position.set(pos[0], pos[1], pos[2]);
            lantern.castShadow = true;
            lantern.receiveShadow = true;
            scene.add(lantern);
        });

        const burnerMat = new THREE.MeshStandardMaterial({ color: 0x6b4a3a, roughness: 0.8 });
        const burner = new THREE.Mesh(
            new THREE.CylinderGeometry(0.6, 0.7, 0.2, 16),
            burnerMat
        );
        burner.position.set(0, 0.3, 1.0);
        burner.castShadow = true;
        burner.receiveShadow = true;
        scene.add(burner);

        const burnerTop = new THREE.Mesh(
            new THREE.CylinderGeometry(0.4, 0.4, 0.1, 16),
            new THREE.MeshStandardMaterial({ color: 0x8b5a3a })
        );
        burnerTop.position.set(0, 0.45, 1.0);
        burnerTop.castShadow = true;
        burnerTop.receiveShadow = true;
        scene.add(burnerTop);

        const controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.06;
        controls.autoRotate = true;
        controls.autoRotateSpeed = 0.7;
        controls.enableZoom = true;
        controls.enablePan = true;
        controls.enableRotate = true;
        controls.enableTouchRotate = true;
        controls.target.set(0, 1.2, 0);

        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
        }
        animate();

        window.addEventListener('resize', () => {
            const w = canvas.clientWidth;
            const h = canvas.clientHeight;
            renderer.setSize(w, h);
            camera.aspect = w / h;
            camera.updateProjectionMatrix();
        });

        // ---------- äº’å‹•æ ¸å¿ƒ Â· ç«‹é«”è–ç­Šå‹•ç•« + å®Œæ•´ç¥ç¦è© ----------
        const moon = document.getElementById('moonDisplay');
        const resultMsg = document.getElementById('resultMessage');
        const shakeArea = document.getElementById('shakeArea');
        const blessDisplay = document.getElementById('blessDisplay');
        const audio = document.getElementById('bgMusic');
        const musicBtn = document.getElementById('musicToggle');
        let isPlaying = false;

        // Patty ç¥ç¦è©åº«ï¼ˆæ¯å¥é–‹é ­éƒ½æœ‰Pattyï¼‰
        const blessings = [
            "ğŸ´ Patty ç¥æ‚¨é¦¬å¹´å¤§å‰ Â· å¹³å®‰é †é‚",
            "ğŸ§§ Patty è³€æ‚¨æ­å–œç™¼è²¡ Â· è²¡æºå»£é€²",
            "ğŸ’° Patty è³œæ‚¨è²¡æºæ»¾æ»¾ Â· å¯Œè²´å¹´å¹´",
            "ğŸŒ¸ Patty é¡˜æ‚¨é¦¬åˆ°æˆåŠŸ Â· æ­¥æ­¥é«˜å‡",
            "ğŸ® Patty é€æ‚¨è–ç­Šé€£é€£ Â· å¥½é‹ä¸æ–·",
            "âœ¨ Patty ç¥ˆæ‚¨é‡‘é¦¬ç»ç‘ Â· å‰æ˜Ÿé«˜ç…§",
            "ğŸ‹ Patty ç›¼æ‚¨ä¸€é¦¬ç•¶å…ˆ Â· å‰ç¨‹è¬é‡Œ",
            "ğŸŠ Patty è´ˆæ‚¨å¤§å‰å¤§åˆ© Â· äº‹äº‹å¦‚æ„",
            "ğŸ‡ Patty ç¥æ‚¨ç­–é¦¬æšé­ Â· éµ¬ç¨‹è¬é‡Œ",
            "ğŸŠ Patty è³€æ‚¨äº”ç¦è‡¨é–€ Â· é—”å®¶å¹³å®‰",
            "ğŸ¥¢ Patty è³œæ‚¨è–ç­Šè–ç­Š Â· å¿ƒæƒ³äº‹æˆ",
            "ğŸ Patty é¡˜æ‚¨é¦¬å¹´ç™¼è²¡ Â· å¥½é‹æ—ºä¾†"
        ];

        // éŸ³æ¨‚åˆå§‹
        audio.volume = 0.35;
        audio.play().then(() => {
            isPlaying = true;
            musicBtn.textContent = 'ğŸ”Š';
        }).catch(() => {
            isPlaying = false;
            musicBtn.textContent = 'ğŸ”‡';
        });

        musicBtn.addEventListener('click', () => {
            if (isPlaying) {
                audio.pause();
                musicBtn.textContent = 'ğŸ”‡';
            } else {
                audio.play();
                musicBtn.textContent = 'ğŸ”Š';
            }
            isPlaying = !isPlaying;
        });

        // è–ç­Šï¼ï¼ ç«‹é«”ç¿»è½‰å‹•ç•«ï¼‹ç¥ç¦è©æ›´æ–°
        function doSheng() {
            // ç§»é™¤èˆŠå‹•ç•«ï¼Œé‡æ–°è§¸ç™¼
            moon.classList.remove('sheng-active');
            void moon.offsetWidth; // å¼·åˆ¶é‡ç¹ª
            moon.classList.add('sheng-active');

            // ç­Šæ¯åœ–æ¡ˆç¶­æŒ
            moon.textContent = 'ğŸ¥¢ğŸ¥¢';
            resultMsg.innerHTML = 'ğŸ¥¢ğŸ¥¢ Patty ç¥è–ç­Š';

            // éš¨æ©ŸæŠ½å–Pattyç¥ç¦
            const text = blessings[Math.floor(Math.random() * blessings.length)];
            blessDisplay.textContent = text;

            // éœ‡å‹•å›é¥‹
            if (navigator.vibrate) navigator.vibrate([20, 30, 20]);

            // å»¶é²ç§»é™¤classï¼ˆä¿ç•™å¾ªç’°å‹•ç•«å¯é‡è¤‡è§¸ç™¼ï¼‰
            setTimeout(() => {
                moon.classList.remove('sheng-active');
            }, 600);
        }

        // æ–æ™ƒåµæ¸¬ï¼ˆæ‰‹æ©Ÿï¼‰
        let lastShake = 0;
        if (window.DeviceMotionEvent) {
            window.addEventListener('devicemotion', (e) => {
                const acc = e.accelerationIncludingGravity;
                if (!acc) return;
                const now = Date.now();
                if (now - lastShake < 1000) return;
                const x = Math.abs(acc.x || 0);
                const y = Math.abs(acc.y || 0);
                const z = Math.abs(acc.z || 0);
                if ((x > 9.8 || y > 9.8 || z > 9.8) && (x + y + z > 25)) {
                    lastShake = now;
                    doSheng();
                }
            });
        }

        // é»æ“Šç­Šæ¯ & æŒ‰éˆ•
        moon.addEventListener('click', doSheng);
        shakeArea.addEventListener('click', doSheng);

        // åˆå§‹ç¥ç¦é¡¯ç¤º
        blessDisplay.textContent = "ğŸ´ æ–æ‰‹æ©Ÿ Â· å¾—è–ç­Š Â· Patty ç¥æ‚¨é¦¬å¹´å¤§å‰";
    </script>
</body>
</html>