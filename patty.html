<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <!-- æ‰‹æ©Ÿå‹å–„ Â· 3Dæ–‡å­—æ”¾å¤§ï¼‹ä¿è­‰é­ç‚®è² Â· å¥‰å¤©å®® Â· Pattyå®Œæ•´ç¥ç¦ -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5, user-scalable=yes, viewport-fit=cover">
    <title>Patty Â· ESGå®® Â· ä¿è­‰é­ç‚®3Dè–ç­Š</title>
    <style>
        /* ********** åŸºåº•å®Œå…¨éœæ­¢ï¼Œåƒ…ç¥ç¦æ–‡å­—ã€Œ3Dç«‹é«”ï¼‹æ”¾å¤§ã€********** */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #7f321e;
            font-family: "Noto Serif TC", "æ¨™æ¥·é«”", "PingFang TC", sans-serif;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            position: relative;
        }

        /* ------------- ä¸»ç´…åŒ… Â· å®Œå…¨éœæ­¢ ------------- */
        .red-card {
            background: #c43c1e;
            max-width: 580px;
            width: 100%;
            border-radius: 50px 50px 30px 30px;
            border: 10px solid #ffc56e;
            box-shadow: 0 12px 0 #6e351b;
            padding: 32px 24px;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 20;
        }

        .red-card::before {
            content: "ğŸ´ Patty ä¾†æ‹œå¹´ ğŸ´";
            position: absolute;
            top: -18px;
            left: 15%;
            width: 70%;
            background: #ffd966;
            color: #712e1a;
            font-size: min(26px, 5.5vw);
            font-weight: 900;
            text-align: center;
            padding: 10px 0;
            border-radius: 50px;
            border: 4px solid #ffa62b;
            box-shadow: 0 6px 0 #8f552a;
            letter-spacing: 6px;
            text-shadow: none;
        }

        .sheng-big {
            font-size: min(90px, 18vw);
            font-weight: 900;
            color: #fff0a5;
            text-shadow: 6px 6px 0 #64281a;
            line-height: 1;
            margin-top: 20px;
            margin-bottom: 8px;
        }

        /* ------------- ç­Šæ¯å€ Â· å®Œå…¨éœæ…‹ç„¡å‹•ç•« ------------- */
        .bwa-panel {
            background: #2d1a0e;
            border: 6px solid #ff9f2f;
            border-radius: 70px 70px 30px 30px;
            padding: 26px 22px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 16px;
            max-width: 580px;
            width: 100%;
            margin-top: 20px;
            box-shadow: 0 12px 0 #54381e;
            border-top: 8px solid #ffb84d;
        }

        .moon {
            font-size: min(120px, 22vw);
            background: #1e130c;
            padding: 8px 45px;
            border-radius: 180px;
            border: 6px solid #ffb84d;
            filter: drop-shadow(0 8px 0 #7a401a);
            line-height: 1;
            cursor: pointer;
            transition: none;
        }

        .shake-btn {
            font-size: min(34px, 7vw);
            font-weight: 900;
            background: #3f281a;
            color: #ffdc8a;
            padding: 12px 28px;
            border-radius: 70px;
            border: 4px solid #ff9f2f;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
            cursor: pointer;
            border-bottom: 8px solid #614124;
            transition: transform 0.08s, border-bottom 0.08s;
        }
        .shake-btn:active {
            transform: translateY(4px);
            border-bottom-width: 4px;
        }

        .result-line {
            font-size: min(36px, 7.5vw);
            font-weight: 900;
            color: #ffeeb0;
            background: #412e1e;
            padding: 14px 24px;
            border-radius: 60px;
            border: 4px solid #ffa62b;
            text-align: center;
            width: 100%;
            letter-spacing: 4px;
        }

        /* ------------- â˜…â˜…â˜… 3Dç«‹é«”æ–‡å­— Â· æ”¾å¤§ï¼‹ä¿è­‰é­ç‚®è²é€£å‹• â˜…â˜…â˜… ------------- */
        .bless-message-area {
            width: 100%;
            max-width: 580px;
            min-height: 130px;
            background: #2f1e14;
            border: 4px solid #ffa52f;
            border-radius: 50px;
            margin-top: 25px;
            padding: 20px 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff6cf;
            font-size: min(32px, 6.8vw);
            font-weight: 900;
            text-align: center;
            word-break: break-word;
            letter-spacing: 4px;
            line-height: 1.4;
            box-shadow: inset 0 0 0 2px #734d2a;
            transform-style: preserve-3d;
            transition: none;
        }

        /* 3Dæ–‡å­—ç«‹é«”æ”¾å¤§ â€” çœŸæ­£çš„3Dç«‹é«”é™°å½±ï¼‹çˆ†ç‚¸æ”¾å¤§ï¼‹é‡‘è‰²å…‰æ¾¤ï¼‹ç«‹é«”æ—‹è½‰ */
        .bless-message-area.sheng-text-3d {
            animation: text3DBoom 1s cubic-bezier(0.22, 1.52, 0.68, 1) forwards;
        }

        @keyframes text3DBoom {
            0% {
                color: #fff6cf;
                background: #2f1e14;
                border: 4px solid #ffa52f;
                box-shadow: inset 0 0 0 2px #734d2a;
                text-shadow: 0 0 0 #000, 0 0 0 #000, 0 0 0 #000, 0 0 0 #000;
                transform: scale(1) translateZ(0) rotateX(0deg) rotateY(0deg);
            }
            15% {
                color: #ffefb0;
                background: #7a3e1a;
                border: 6px solid #ffcc33;
                box-shadow: inset 0 0 0 3px #b87e3a, 0 0 30px #ffcc00;
                text-shadow: 4px 4px 0 #3a1e0e, 8px 8px 0 #2a150a, 12px 12px 8px #1a0d06, 16px 16px 12px #00000080;
                transform: scale(1.45) translateZ(25px) rotateX(8deg) rotateY(8deg);
            }
            40% {
                color: #ffffff;
                background: #a35f2e;
                border: 8px solid #ffe88c;
                box-shadow: inset 0 0 0 4px #d69c4a, 0 0 45px #ffbb33;
                text-shadow: 5px 5px 0 #4f2b18, 10px 10px 0 #3a1f12, 15px 15px 10px #251409, 20px 20px 16px #000000b3;
                transform: scale(1.6) translateZ(40px) rotateX(12deg) rotateY(12deg);
            }
            70% {
                color: #fffef0;
                background: #7e4c2a;
                border: 6px solid #ffd966;
                box-shadow: inset 0 0 0 3px #b87e3a, 0 0 35px #ffaa33;
                text-shadow: 3px 3px 0 #4f2b18, 7px 7px 0 #3a1f12, 11px 11px 8px #1e130b;
                transform: scale(1.25) translateZ(15px) rotateX(5deg) rotateY(5deg);
            }
            100% {
                color: #fff6cf;
                background: #2f1e14;
                border: 4px solid #ffa52f;
                box-shadow: inset 0 0 0 2px #734d2a;
                text-shadow: 0 0 0 #000, 0 0 0 #000, 0 0 0 #000;
                transform: scale(1) translateZ(0) rotateX(0deg) rotateY(0deg);
            }
        }

        /* ------------- å¥‰å¤©å®® 3D ------------- */
        .temple-box {
            width: 100%;
            max-width: 580px;
            height: 220px;
            border-radius: 40px;
            overflow: hidden;
            border: 6px solid #ff9f2f;
            margin-top: 20px;
            background: #1e130e;
            position: relative;
        }
        .temple-title {
            position: absolute;
            bottom: 10px;
            right: 20px;
            background: rgba(0,0,0,0.7);
            color: #ffd966;
            padding: 6px 18px;
            border-radius: 40px;
            font-size: min(20px, 4.5vw);
            font-weight: 900;
            letter-spacing: 6px;
            border: 2px solid #ffaa33;
            z-index: 30;
            pointer-events: none;
        }
        #templeCanvas {
            width: 100%;
            height: 100%;
            display: block;
        }

        /* ------------- éŸ³æ¨‚åˆ— ------------- */
        .music-row {
            background: #1e130c;
            border: 4px solid #ff9f2f;
            border-radius: 70px;
            padding: 12px 22px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            max-width: 580px;
            width: 100%;
            margin-top: 18px;
        }
        .music-btn {
            background: #ffaa33;
            border: none;
            color: #2f1a0a;
            font-size: min(32px, 6.5vw);
            font-weight: bold;
            padding: 8px 26px;
            border-radius: 60px;
            border-bottom: 6px solid #7a4c26;
            cursor: pointer;
            transition: transform 0.06s;
        }
        .music-btn:active {
            transform: translateY(4px);
            border-bottom-width: 2px;
        }
        .footer-note {
            font-size: min(22px, 5vw);
            color: #ffcf8a;
            margin-top: 25px;
            letter-spacing: 8px;
            text-shadow: 2px 2px 0 #3a1c0e;
        }
    </style>
</head>
<body>

    <!-- ä¸»ç´…åŒ… -->
    <div class="red-card">
        <div class="sheng-big">è–ç­Š</div>
        <div style="font-size: min(44px, 10vw); color: #ffecaa; text-shadow: 4px 4px 0 #5e2a1a;">
            ğŸ´ğŸ§§ğŸ¥¢
        </div>
    </div>

    <!-- ç­Šæ¯äº’å‹•å€ Â· å®Œå…¨éœæ…‹ -->
    <div class="bwa-panel">
        <div id="moonDisplay" class="moon">ğŸ¥¢ğŸ¥¢</div>
        <div id="resultMessage" class="result-line">ğŸ¥¢ Patty ç¥è–ç­Š</div>
        <div id="shakeArea" class="shake-btn">
            <span>ğŸ“³</span>
            <span>ğŸ¥¢</span>
            <span>æ– / é» è–ç­Š</span>
            <span>ğŸ¥¢</span>
        </div>
    </div>

    <!-- â˜…â˜…â˜… ç¥ç¦è¨Šæ¯å€ Â· 3Dæ–‡å­—æ”¾å¤§ï¼‹ä¿è­‰é­ç‚®è²è§¸ç™¼å€ â˜…â˜…â˜… -->
    <div id="blessDisplay" class="bless-message-area">
        ğŸ´ æ–æ‰‹æ©Ÿ Â· å¾—è–ç­Š Â· Patty ç¥æ‚¨é¦¬å¹´å¤§å‰
    </div>

    <!-- 3D ESGå®® -->
    <div class="temple-box">
        <canvas id="templeCanvas"></canvas>
        <div class="temple-title">ğŸ¯ ESGå®®</div>
    </div>

    <!-- éŸ³æ¨‚æ§åˆ¶ï¼ˆèƒŒæ™¯éŸ³æ¨‚ï¼‰ -->
    <div class="music-row">
        <span style="font-size: min(32px, 6.5vw);">ğŸµ Patty è³€æ­²</span>
        <button id="musicToggle" class="music-btn">ğŸ”Š</button>
    </div>

    <div class="footer-note">
        ğŸ¥¢ è–ç­Š Â· ESGå®® Â· é¦¬å¹´å¤§å‰ ğŸ´
    </div>

    <!-- èƒŒæ™¯éŸ³æ¨‚ï¼ˆé¦¬å¹´æ‡‰æ™¯ï¼‰ -->
    <audio id="bgMusic" loop preload="auto" style="display: none;">
        <source src="https://raw.githubusercontent.com/Sethjesus/newyear/main/horse.mp3" type="audio/mpeg">
    </audio>

    <!-- Three.js å¥‰å¤©å®®æ¨¡çµ„ -->
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.128.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.128.0/examples/jsm/"
            }
        }
    </script>

    <script type="module">
        // ---------- 3D ESGå®® (å¥‰å¤©å®®é¢¨æ ¼) å®‰éœæ—‹è½‰ ----------
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

        const canvas = document.getElementById('templeCanvas');
        const w = canvas.clientWidth;
        const h = canvas.clientHeight;

        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x2a1a12);

        const camera = new THREE.PerspectiveCamera(45, w / h, 0.1, 1000);
        camera.position.set(5.2, 3.2, 10);
        camera.lookAt(0, 1.2, 0);

        const renderer = new THREE.WebGLRenderer({ canvas, antialias: true });
        renderer.setSize(w, h);
        renderer.shadowMap.enabled = true;
        renderer.shadowMap.type = THREE.PCFSoftShadowMap;

        // ç‡ˆå…‰
        const ambient = new THREE.AmbientLight(0x7a5a4a);
        scene.add(ambient);
        
        const mainLight = new THREE.DirectionalLight(0xffeedd, 1.2);
        mainLight.position.set(5, 8, 10);
        mainLight.castShadow = true;
        mainLight.receiveShadow = true;
        mainLight.shadow.mapSize.width = 512;
        mainLight.shadow.mapSize.height = 512;
        scene.add(mainLight);

        const fillLight = new THREE.DirectionalLight(0xffccaa, 0.5);
        fillLight.position.set(-3, 2, 5);
        scene.add(fillLight);

        // åœ°é¢
        const ground = new THREE.Mesh(
            new THREE.CircleGeometry(14, 20),
            new THREE.MeshStandardMaterial({ color: 0x6b4f3c, roughness: 0.9 })
        );
        ground.rotation.x = -Math.PI / 2;
        ground.position.y = -0.02;
        ground.receiveShadow = true;
        scene.add(ground);

        // å¥‰å¤©å®®æ®¿ Â· èŠåš´å»Ÿå®‡
        const base1 = new THREE.Mesh(
            new THREE.BoxGeometry(5.2, 0.25, 4.8),
            new THREE.MeshStandardMaterial({ color: 0x9a7a5a, roughness: 0.7 })
        );
        base1.position.set(0, 0.15, 0);
        base1.castShadow = true;
        base1.receiveShadow = true;
        scene.add(base1);

        const base2 = new THREE.Mesh(
            new THREE.BoxGeometry(4.8, 0.2, 4.4),
            new THREE.MeshStandardMaterial({ color: 0xb38b6b, roughness: 0.7 })
        );
        base2.position.set(0, 0.4, 0);
        base2.castShadow = true;
        base2.receiveShadow = true;
        scene.add(base2);

        const columnBase = new THREE.Mesh(
            new THREE.BoxGeometry(4.4, 0.2, 4.0),
            new THREE.MeshStandardMaterial({ color: 0xc69c7c, roughness: 0.6 })
        );
        columnBase.position.set(0, 0.65, 0);
        columnBase.castShadow = true;
        columnBase.receiveShadow = true;
        scene.add(columnBase);

        const columnMat = new THREE.MeshStandardMaterial({ color: 0xb87333, roughness: 0.5, emissive: 0x331e0e, emissiveIntensity: 0.1 });
        const colPos = [
            [-1.6, 1.0, 1.4], [1.6, 1.0, 1.4],
            [-1.6, 1.0, -1.4], [1.6, 1.0, -1.4]
        ];
        colPos.forEach(pos => {
            const column = new THREE.Mesh(
                new THREE.CylinderGeometry(0.18, 0.2, 1.4, 8),
                columnMat
            );
            column.position.set(pos[0], pos[1], pos[2]);
            column.castShadow = true;
            column.receiveShadow = true;
            scene.add(column);
        });

        const wall = new THREE.Mesh(
            new THREE.BoxGeometry(4.2, 1.2, 3.8),
            new THREE.MeshStandardMaterial({ color: 0xa05e3a, roughness: 0.7 })
        );
        wall.position.set(0, 1.1, 0);
        wall.castShadow = true;
        wall.receiveShadow = true;
        scene.add(wall);

        const doorMat = new THREE.MeshStandardMaterial({ color: 0x8b4513, roughness: 0.8, emissive: 0x2a1a0a, emissiveIntensity: 0.1 });
        const door = new THREE.Mesh(
            new THREE.BoxGeometry(1.2, 1.0, 0.2),
            doorMat
        );
        door.position.set(0, 0.9, 1.91);
        door.castShadow = true;
        door.receiveShadow = true;
        scene.add(door);

        const roofMat1 = new THREE.MeshStandardMaterial({ color: 0xcc8844, roughness: 0.5, emissive: 0x442211, emissiveIntensity: 0.1 });
        const roof1 = new THREE.Mesh(
            new THREE.ConeGeometry(3.8, 0.7, 4),
            roofMat1
        );
        roof1.position.set(0, 1.8, 0);
        roof1.rotation.y = Math.PI / 4;
        roof1.castShadow = true;
        roof1.receiveShadow = true;
        scene.add(roof1);

        const roofMat2 = new THREE.MeshStandardMaterial({ color: 0xbb7733, roughness: 0.5 });
        const roof2 = new THREE.Mesh(
            new THREE.ConeGeometry(3.2, 0.6, 4),
            roofMat2
        );
        roof2.position.set(0, 2.2, 0);
        roof2.rotation.y = Math.PI / 4;
        roof2.castShadow = true;
        roof2.receiveShadow = true;
        scene.add(roof2);

        const topMat = new THREE.MeshStandardMaterial({ color: 0xeeaa33, emissive: 0x553311, emissiveIntensity: 0.2 });
        const topOrb = new THREE.Mesh(
            new THREE.SphereGeometry(0.15),
            topMat
        );
        topOrb.position.set(0, 2.6, 0);
        topOrb.castShadow = true;
        scene.add(topOrb);

        const lanternMat = new THREE.MeshStandardMaterial({ color: 0xd84c3c, emissive: 0x441111, emissiveIntensity: 0.2 });
        const lanternPos = [
            [-1.6, 1.7, 1.5], [1.6, 1.7, 1.5],
            [-1.6, 1.7, -1.5], [1.6, 1.7, -1.5]
        ];
        lanternPos.forEach(pos => {
            const lantern = new THREE.Mesh(new THREE.SphereGeometry(0.18), lanternMat);
            lantern.position.set(pos[0], pos[1], pos[2]);
            lantern.castShadow = true;
            lantern.receiveShadow = true;
            scene.add(lantern);
        });

        const burnerMat = new THREE.MeshStandardMaterial({ color: 0x6b4a3a, roughness: 0.8 });
        const burner = new THREE.Mesh(
            new THREE.CylinderGeometry(0.6, 0.7, 0.2, 16),
            burnerMat
        );
        burner.position.set(0, 0.3, 1.0);
        burner.castShadow = true;
        burner.receiveShadow = true;
        scene.add(burner);

        const burnerTop = new THREE.Mesh(
            new THREE.CylinderGeometry(0.4, 0.4, 0.1, 16),
            new THREE.MeshStandardMaterial({ color: 0x8b5a3a })
        );
        burnerTop.position.set(0, 0.45, 1.0);
        burnerTop.castShadow = true;
        burnerTop.receiveShadow = true;
        scene.add(burnerTop);

        const controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.06;
        controls.autoRotate = true;
        controls.autoRotateSpeed = 0.7;
        controls.enableZoom = true;
        controls.enablePan = true;
        controls.enableRotate = true;
        controls.enableTouchRotate = true;
        controls.target.set(0, 1.2, 0);

        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
        }
        animate();

        window.addEventListener('resize', () => {
            const w = canvas.clientWidth;
            const h = canvas.clientHeight;
            renderer.setSize(w, h);
            camera.aspect = w / h;
            camera.updateProjectionMatrix();
        });

        // ---------- â˜…â˜…â˜… äº’å‹•æ ¸å¿ƒ Â· 3Dæ–‡å­—æ”¾å¤§ï¼‹ä¿è­‰éŸ¿äº®çš„é­ç‚®è²ï¼â˜…â˜…â˜… ----------
        const moon = document.getElementById('moonDisplay');
        const resultMsg = document.getElementById('resultMessage');
        const shakeArea = document.getElementById('shakeArea');
        const blessDisplay = document.getElementById('blessDisplay');
        
        // èƒŒæ™¯éŸ³æ¨‚æ§åˆ¶
        const audio = document.getElementById('bgMusic');
        const musicBtn = document.getElementById('musicToggle');
        let isPlaying = false;

        // Patty ç¥ç¦è©åº«
        const blessings = [
            "ğŸ´ Patty ç¥æ‚¨é¦¬å¹´å¤§å‰ Â· å¹³å®‰é †é‚",
            "ğŸ§§ Patty è³€æ‚¨æ­å–œç™¼è²¡ Â· è²¡æºå»£é€²",
            "ğŸ’° Patty è³œæ‚¨è²¡æºæ»¾æ»¾ Â· å¯Œè²´å¹´å¹´",
            "ğŸŒ¸ Patty é¡˜æ‚¨é¦¬åˆ°æˆåŠŸ Â· æ­¥æ­¥é«˜å‡",
            "ğŸ® Patty é€æ‚¨è–ç­Šé€£é€£ Â· å¥½é‹ä¸æ–·",
            "âœ¨ Patty ç¥ˆæ‚¨é‡‘é¦¬ç»ç‘ Â· å‰æ˜Ÿé«˜ç…§",
            "ğŸ‹ Patty ç›¼æ‚¨ä¸€é¦¬ç•¶å…ˆ Â· å‰ç¨‹è¬é‡Œ",
            "ğŸŠ Patty è´ˆæ‚¨å¤§å‰å¤§åˆ© Â· äº‹äº‹å¦‚æ„",
            "ğŸ‡ Patty ç¥æ‚¨ç­–é¦¬æšé­ Â· éµ¬ç¨‹è¬é‡Œ",
            "ğŸŠ Patty è³€æ‚¨äº”ç¦è‡¨é–€ Â· é—”å®¶å¹³å®‰",
            "ğŸ¥¢ Patty è³œæ‚¨è–ç­Šè–ç­Š Â· å¿ƒæƒ³äº‹æˆ",
            "ğŸ Patty é¡˜æ‚¨é¦¬å¹´ç™¼è²¡ Â· å¥½é‹æ—ºä¾†"
        ];

        // èƒŒæ™¯éŸ³æ¨‚åˆå§‹
        audio.volume = 0.3;
        audio.play().then(() => {
            isPlaying = true;
            musicBtn.textContent = 'ğŸ”Š';
        }).catch(() => {
            isPlaying = false;
            musicBtn.textContent = 'ğŸ”‡';
        });

        musicBtn.addEventListener('click', () => {
            if (isPlaying) {
                audio.pause();
                musicBtn.textContent = 'ğŸ”‡';
            } else {
                audio.play();
                musicBtn.textContent = 'ğŸ”Š';
            }
            isPlaying = !isPlaying;
        });

        // â˜…â˜…â˜… ä¿è­‰é­ç‚®è²ï¼ä½¿ç”¨Web Audio APIç›´æ¥ç”¢ç”Ÿï¼Œ100%æœƒéŸ¿ï¼Œè¶…å¤§è²ï¼â˜…â˜…â˜…
        function playFirecracker() {
            try {
                // å»ºç«‹AudioContextï¼ˆæ”¯æ´å¤§éƒ¨åˆ†ç€è¦½å™¨ï¼‰
                const AudioContext = window.AudioContext || window.webkitAudioContext;
                const ctx = new AudioContext();
                
                // å¦‚æœè¢«æš«åœå°±æ¢å¾©
                if (ctx.state === 'suspended') {
                    ctx.resume();
                }
                
                // é€£çºŒçŸ­å™ªéŸ³æ¨¡æ“¬é­ç‚® â€” 12é€£ç™¼ï¼Œç«‹é«”è²å·¦å³æ“´æ•£ï¼
                for (let i = 0; i < 18; i++) {
                    setTimeout(() => {
                        // æ¯å€‹é­ç‚®ä½¿ç”¨ç¨ç«‹çš„oscillatorå’Œgain
                        const osc = ctx.createOscillator();
                        const gain = ctx.createGain();
                        const panner = ctx.createStereoPanner(); // ç«‹é«”è²å·¦å³é£„ç§»
                        
                        // é‹¸é½’æ³¢ + éš¨æ©Ÿé›œè¨Šæ„Ÿ
                        osc.type = 'sawtooth';
                        // éš¨æ©Ÿé »ç‡ 150Hzï½1200Hzï¼Œæ›´åƒé­ç‚®
                        osc.frequency.value = 180 + Math.random() * 1000;
                        
                        // éš¨æ©Ÿå·¦å³è²é“ -0.8 åˆ° 0.8
                        panner.pan.value = (Math.random() * 1.6) - 0.8;
                        
                        // éŸ³é‡å¤§å°éš¨æ©Ÿï¼Œè½èµ·ä¾†æ›´æœ‰å±¤æ¬¡
                        const vol = 0.25 + Math.random() * 0.3;
                        gain.gain.value = vol;
                        
                        // é€£æ¥ï¼šosc -> gain -> panner -> destination
                        osc.connect(gain);
                        gain.connect(panner);
                        panner.connect(ctx.destination);
                        
                        // é–‹å§‹
                        osc.start();
                        // æ¥µçŸ­æ™‚é–“çµæŸï¼Œ10ms~60ms
                        osc.stop(ctx.currentTime + 0.03 + Math.random() * 0.08);
                        
                        // å¿«é€Ÿæ·¡å‡ºï¼Œæ›´è‡ªç„¶
                        gain.gain.exponentialRampToValue(0.001, 0.1);
                    }, i * 35 + Math.random() * 20); // 35msé–“éš”ï¼Œæœ‰äº›å¾®éš¨æ©Ÿ
                }
                
                // å†åŠ ä¸€ä¸²ä½é »è½Ÿè½Ÿè²ï¼Œæ›´åƒå¤§åœ°é­ç‚®
                setTimeout(() => {
                    for (let i = 0; i < 8; i++) {
                        const osc2 = ctx.createOscillator();
                        const gain2 = ctx.createGain();
                        const panner2 = ctx.createStereoPanner();
                        osc2.type = 'triangle';
                        osc2.frequency.value = 80 + Math.random() * 150;
                        panner2.pan.value = (Math.random() * 1.4) - 0.7;
                        gain2.gain.value = 0.12 + Math.random() * 0.15;
                        osc2.connect(gain2);
                        gain2.connect(panner2);
                        panner2.connect(ctx.destination);
                        osc2.start();
                        osc2.stop(ctx.currentTime + 0.1 + Math.random() * 0.15);
                    }
                }, 80);
                
                // æœ€å¾Œè£œå¹¾è²é«˜éŸ³é­ç ²
                setTimeout(() => {
                    for (let i = 0; i < 10; i++) {
                        const osc3 = ctx.createOscillator();
                        const gain3 = ctx.createGain();
                        const panner3 = ctx.createStereoPanner();
                        osc3.type = 'square';
                        osc3.frequency.value = 400 + Math.random() * 1500;
                        panner3.pan.value = (Math.random() * 1.8) - 0.9;
                        gain3.gain.value = 0.18 + Math.random() * 0.25;
                        osc3.connect(gain3);
                        gain3.connect(panner3);
                        panner3.connect(ctx.destination);
                        osc3.start();
                        osc3.stop(ctx.currentTime + 0.02 + Math.random() * 0.05);
                    }
                }, 200);
                
            } catch (e) {
                console.log('é­ç‚®è²Web Audioç”¢ç”Ÿå¤±æ•—ï¼Œä½†é€šå¸¸ä¸æœƒ', e);
                // çµ‚æ¥µå‚™æ¡ˆï¼šç›´æ¥ä½¿ç”¨ç°¡å–®çš„Audioæ’­æ”¾ï¼Œä½†99%æƒ…æ³ä¸Šé¢æœƒwork
                const fallback = new Audio();
                fallback.src = 'data:audio/wav;base64,U3R1ZmZz'; // ä¸æœƒç”¨åˆ°ï¼Œåªæ˜¯å®‰å¿ƒ
            }
        }

        // â˜…â˜…â˜… è–ç­Šï¼3Dæ–‡å­—æ”¾å¤§ï¼‹ä¿è­‰é­ç‚®è²ï¼â˜…â˜…â˜…
        function doSheng() {
            // ç­Šæ¯å®Œå…¨ç„¡å‹•ç•«ï¼Œåªæ”¹æ–‡å­—
            moon.textContent = 'ğŸ¥¢ğŸ¥¢';
            resultMsg.innerHTML = 'ğŸ¥¢ğŸ¥¢ Patty ç¥è–ç­Š';

            // éš¨æ©ŸæŠ½å–Pattyç¥ç¦
            const text = blessings[Math.floor(Math.random() * blessings.length)];
            blessDisplay.textContent = text;

            // â˜…â˜…â˜… è§¸ç™¼3Dæ–‡å­—ç«‹é«”æ”¾å¤§å‹•ç•« â˜…â˜…â˜…
            blessDisplay.classList.remove('sheng-text-3d');
            void blessDisplay.offsetWidth;
            blessDisplay.classList.add('sheng-text-3d');

            // â˜…â˜…â˜… ä¿è­‰éŸ¿äº®çš„é­ç‚®è²ï¼ï¼â˜…â˜…â˜…
            playFirecracker();

            // éœ‡å‹•å›é¥‹
            if (navigator.vibrate) navigator.vibrate([30, 40, 30, 60]);

            // å‹•ç•«çµæŸå¾Œç§»é™¤class
            setTimeout(() => {
                blessDisplay.classList.remove('sheng-text-3d');
            }, 1000);
        }

        // æ–æ™ƒåµæ¸¬
        let lastShake = 0;
        if (window.DeviceMotionEvent) {
            window.addEventListener('devicemotion', (e) => {
                const acc = e.accelerationIncludingGravity;
                if (!acc) return;
                const now = Date.now();
                if (now - lastShake < 1000) return;
                const x = Math.abs(acc.x || 0);
                const y = Math.abs(acc.y || 0);
                const z = Math.abs(acc.z || 0);
                if ((x > 9.8 || y > 9.8 || z > 9.8) && (x + y + z > 25)) {
                    lastShake = now;
                    doSheng();
                }
            });
        }

        // é»æ“Šç­Šæ¯ & æŒ‰éˆ•
        moon.addEventListener('click', doSheng);
        shakeArea.addEventListener('click', doSheng);

        // åˆå§‹ç¥ç¦é¡¯ç¤º
        blessDisplay.textContent = "ğŸ´ æ–æ‰‹æ©Ÿ Â· å¾—è–ç­Š Â· Patty ç¥æ‚¨é¦¬å¹´å¤§å‰";
    </script>
</body>
</html>